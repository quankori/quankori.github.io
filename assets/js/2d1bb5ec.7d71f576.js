"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6769],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>d});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=s(n),g=o,d=u["".concat(p,".").concat(g)]||u[g]||m[g]||a;return n?r.createElement(d,i(i({ref:t},l),{},{components:n})):r.createElement(d,i({ref:t},l))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=g;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c[u]="string"==typeof e?e:o,i[1]=c;for(var s=2;s<a;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},216:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>c,toc:()=>s});var r=n(7462),o=(n(7294),n(3905));const a={title:"Pipes"},i=void 0,c={unversionedId:"programming/nestjs/pipes",id:"programming/nestjs/pipes",title:"Pipes",description:"Image",source:"@site/docs/programming/nestjs/pipes.md",sourceDirName:"programming/nestjs",slug:"/programming/nestjs/pipes",permalink:"/docs/programming/nestjs/pipes",draft:!1,tags:[],version:"current",frontMatter:{title:"Pipes"},sidebar:"programming",previous:{title:"Exception filter",permalink:"/docs/programming/nestjs/exception-filter"},next:{title:"Authentication",permalink:"/docs/programming/nestjs/authentication"}},p={},s=[{value:"Concept",id:"concept",level:2},{value:"Code",id:"code",level:2}],l={toc:s},u="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/quankori/quankori.github.io/master/src/images/nestjs/4.png",alt:"Image"})),(0,o.kt)("h2",{id:"concept"},"Concept"),(0,o.kt)("p",null,"Trong NestJS, pipes l\xe0 m\u1ed9t ph\u1ea7n quan tr\u1ecdng c\u1ee7a vi\u1ec7c x\u1eed l\xfd v\xe0 ki\u1ec3m tra d\u1eef li\u1ec7u tr\u01b0\u1edbc khi ch\xfang \u0111\u01b0\u1ee3c truy\u1ec1n v\xe0o c\xe1c route handler (controller methods) \u0111\u1ec3 x\u1eed l\xfd. Pipes gi\xfap ki\u1ec3m tra, bi\u1ebfn \u0111\u1ed5i v\xe0 x\xe1c th\u1ef1c d\u1eef li\u1ec7u tr\u01b0\u1edbc khi n\xf3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong ph\u1ea7n c\xf2n l\u1ea1i c\u1ee7a \u1ee9ng d\u1ee5ng. NestJS cung c\u1ea5p m\u1ed9t s\u1ed1 lo\u1ea1i pipes kh\xe1c nhau \u0111\u1ec3 \u0111\xe1p \u1ee9ng c\xe1c y\xeau c\u1ea7u kh\xe1c nhau c\u1ee7a \u1ee9ng d\u1ee5ng. D\u01b0\u1edbi \u0111\xe2y l\xe0 m\u1ed9t s\u1ed1 lo\u1ea1i pipes c\u01a1 b\u1ea3n trong NestJS"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Validation Pipe"),":\nValidation Pipe \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ki\u1ec3m tra v\xe0 x\xe1c th\u1ef1c d\u1eef li\u1ec7u d\u1ef1a tr\xean c\xe1c decorator nh\u01b0 @Body(), @Query(), @Param(), @Headers() v\xe0 @Request(). N\xf3 s\u1eed d\u1ee5ng class-validator \u0111\u1ec3 th\u1ef1c hi\u1ec7n ki\u1ec3m tra d\u1eef li\u1ec7u v\xe0 tr\u1ea3 v\u1ec1 c\xe1c l\u1ed7i n\u1ebfu c\xf3."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"ParseInt Pipe"),":\nParseInt Pipe \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 chuy\u1ec3n \u0111\u1ed5i c\xe1c tham s\u1ed1 route ho\u1eb7c query params th\xe0nh ki\u1ec3u s\u1ed1 nguy\xean."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"ParseBool Pipe"),":\nParseBool Pipe \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 chuy\u1ec3n \u0111\u1ed5i c\xe1c gi\xe1 tr\u1ecb boolean t\u1eeb c\xe1c tham s\u1ed1 route ho\u1eb7c query params."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"DefaultValue Pipe"),":\nDefaultValue Pipe cho ph\xe9p b\u1ea1n cung c\u1ea5p gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh cho c\xe1c tham s\u1ed1 route ho\u1eb7c query params khi gi\xe1 tr\u1ecb kh\xf4ng \u0111\u01b0\u1ee3c cung c\u1ea5p."),(0,o.kt)("p",null,"V\xe0 c\xf2n nhi\u1ec1u lo\u1ea1i pipes kh\xe1c nhau t\xf9y thu\u1ed9c v\xe0o y\xeau c\u1ea7u c\u1ee5 th\u1ec3 c\u1ee7a \u1ee9ng d\u1ee5ng."),(0,o.kt)("h2",{id:"code"},"Code"),(0,o.kt)("p",null,"T\u1ea1o v\xe0 \xe1p d\u1ee5ng global Pipes"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"app.useGlobalPipes(\n  new ValidationPipe({\n    whitelist: true,\n    exceptionFactory: (validationErrors: ValidationError[] = []) => {\n      let arrayError = [];\n      validationErrors.forEach((element: ValidationError) => {\n        arrayError.push({\n          field: element.property,\n          message: Object.values(element.constraints)[0],\n        });\n      });\n      return new UnprocessableEntityException(arrayError);\n    },\n  })\n);\n")),(0,o.kt)("p",null,"T\u1ea1o class Pipes"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import {\n  ValidationPipe,\n  ValidationError,\n  UnprocessableEntityException,\n} from "@nestjs/common";\n\nexport class CustomValidationPipe extends ValidationPipe {\n  constructor() {\n    super({\n      whitelist: true,\n      exceptionFactory: (validationErrors: ValidationError[] = []) => {\n        const arrayError = validationErrors.map((element: ValidationError) => ({\n          field: element.property,\n          message: Object.values(element.constraints)[0],\n        }));\n        return new UnprocessableEntityException(arrayError);\n      },\n    });\n  }\n}\n')),(0,o.kt)("p",null,"S\u1eed d\u1ee5ng trong router"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import { Controller, Post, Body, UsePipes } from "@nestjs/common";\nimport { CreateUserDto } from "./create-user.dto";\nimport { ValidationPipe } from "./validation.pipe";\n\n@Controller("users")\nexport class UsersController {\n  @Post()\n  @UsePipes(ValidationPipe)\n  createUser(@Body() createUserDto: CreateUserDto) {\n    // X\u1eed l\xfd logic t\u1ea1o ng\u01b0\u1eddi d\xf9ng\n  }\n}\n')))}m.isMDXComponent=!0}}]);