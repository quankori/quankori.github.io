"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6828],{3905:(e,r,n)=>{n.d(r,{Zo:()=>s,kt:()=>d});var t=n(7294);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function c(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function i(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=t.createContext({}),l=function(e){var r=t.useContext(h),n=r;return e&&(n="function"==typeof e?e(r):c(c({},r),e)),n},s=function(e){var r=l(e.components);return t.createElement(h.Provider,{value:r},e.children)},g="mdxType",p={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},u=t.forwardRef((function(e,r){var n=e.components,o=e.mdxType,a=e.originalType,h=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),g=l(n),u=o,d=g["".concat(h,".").concat(u)]||g[u]||p[u]||a;return n?t.createElement(d,c(c({ref:r},s),{},{components:n})):t.createElement(d,c({ref:r},s))}));function d(e,r){var n=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=n.length,c=new Array(a);c[0]=u;var i={};for(var h in r)hasOwnProperty.call(r,h)&&(i[h]=r[h]);i.originalType=e,i[g]="string"==typeof e?e:o,c[1]=i;for(var l=2;l<a;l++)c[l]=n[l];return t.createElement.apply(null,c)}return t.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2237:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>h,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var t=n(7462),o=(n(7294),n(3905));const a={title:"Worker Thread"},c=void 0,i={unversionedId:"programming/nodejs/worker-thread",id:"programming/nodejs/worker-thread",title:"Worker Thread",description:"Concept",source:"@site/docs/programming/nodejs/worker-thread.md",sourceDirName:"programming/nodejs",slug:"/programming/nodejs/worker-thread",permalink:"/docs/programming/nodejs/worker-thread",draft:!1,tags:[],version:"current",frontMatter:{title:"Worker Thread"},sidebar:"programming",previous:{title:"Loop",permalink:"/docs/programming/nodejs/loop"},next:{title:"Dependency Injection (DI)",permalink:"/docs/programming/nestjs/dependency-injection"}},h={},l=[{value:"Concept",id:"concept",level:2},{value:"Code",id:"code",level:2}],s={toc:l},g="wrapper";function p(e){let{components:r,...n}=e;return(0,o.kt)(g,(0,t.Z)({},s,n,{components:r,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"concept"},"Concept"),(0,o.kt)("p",null,"Worker thread l\xe0 m\u1ed9t kh\xe1i ni\u1ec7m trong l\u1eadp tr\xecnh \u0111a lu\u1ed3ng (multithreading) v\xe0 \u0111a ti\u1ebfn tr\xecnh (multiprocessing), cho ph\xe9p ch\u1ea1y m\xe3 ngu\u1ed3n c\xf9ng m\u1ed9t th\u1eddi \u0111i\u1ec3m tr\xean nhi\u1ec1u lu\u1ed3ng ho\u1eb7c ti\u1ebfn tr\xecnh ri\xeang bi\u1ec7t. Worker threads th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1eadn d\u1ee5ng s\u1ee9c m\u1ea1nh c\u1ee7a c\xe1c CPU \u0111a l\xf5i v\xe0 \u0111\u1ec3 t\u1ed1i \u01b0u h\xf3a hi\u1ec7u su\u1ea5t ch\u01b0\u01a1ng tr\xecnh."),(0,o.kt)("p",null,"M\u1ed9t v\xed d\u1ee5 c\u1ee5 th\u1ec3 v\u1ec1 vi\u1ec7c s\u1eed d\u1ee5ng worker thread \u0111\u1ec3 x\u1eed l\xfd m\u1ed9t t\u1ec7p c\xf3 dung l\u01b0\u1ee3ng l\u1edbn l\xe0 khi b\u1ea1n c\u1ea7n th\u1ef1c hi\u1ec7n c\xe1c ph\xe9p t\xednh ph\u1ee9c t\u1ea1p tr\xean c\xe1c d\u1eef li\u1ec7u trong t\u1ec7p v\xe0 mu\u1ed1n t\u1eadn d\u1ee5ng s\u1ee9c m\u1ea1nh c\u1ee7a nhi\u1ec1u lu\u1ed3ng ho\u1eb7c ti\u1ebfn tr\xecnh \u0111\u1ec3 gi\u1ea3m th\u1eddi gian x\u1eed l\xfd."),(0,o.kt)("h2",{id:"code"},"Code"),(0,o.kt)("p",null,"Trong v\xed d\u1ee5 n\xe0y, main.js l\xe0 t\u1ec7p ch\xednh \u0111\u1ec3 ch\u1ea1y. N\xf3 t\u1ea1o m\u1ed9t worker thread b\u1eb1ng c\xe1ch t\u1ea1o m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng Worker v\xe0 truy\u1ec1n t\xean t\u1ec7p c\u1ee7a worker (worker.js) v\xe0 d\u1eef li\u1ec7u g\u1eedi cho worker. Trong worker thread (worker.js), ch\xfang ta nh\u1eadn d\u1eef li\u1ec7u t\u1eeb workerData, th\u1ef1c hi\u1ec7n m\u1ed9t ph\xe9p bi\u1ebfn \u0111\u1ed5i \u0111\u01a1n gi\u1ea3n, v\xe0 sau \u0111\xf3 g\u1eedi k\u1ebft qu\u1ea3 tr\u1edf l\u1ea1i cho lu\u1ed3ng ch\xednh th\xf4ng qua parentPort."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// main.js\nconst { Worker, isMainThread } = require("worker_threads");\n\nif (isMainThread) {\n  // Ch\u1ea1y trong lu\u1ed3ng ch\xednh\n  console.log("Main thread started.");\n\n  const worker = new Worker("./worker.js", {\n    workerData: "Hello from main.js",\n  });\n\n  worker.on("message", (message) => {\n    console.log(`Received message from worker: ${message}`);\n  });\n\n  worker.on("error", (error) => {\n    console.error(`Worker error: ${error}`);\n  });\n\n  worker.on("exit", (code) => {\n    console.log(`Worker exited with code ${code}`);\n  });\n} else {\n  // Ch\u1ea1y trong worker thread\n  const workerData = require("worker_threads").workerData;\n  console.log(`Worker thread started. Received data: ${workerData}`);\n\n  const result = workerData.toUpperCase();\n\n  // G\u1eedi k\u1ebft qu\u1ea3 v\u1ec1 cho lu\u1ed3ng ch\xednh\n  require("worker_threads").parentPort.postMessage(result);\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// worker.js\nconst { parentPort, workerData } = require("worker_threads");\nconsole.log(`Worker thread started. Received data: ${workerData}`);\n\nconst result = workerData.toLowerCase();\n\n// G\u1eedi k\u1ebft qu\u1ea3 v\u1ec1 cho lu\u1ed3ng ch\xednh\nparentPort.postMessage(result);\n')),(0,o.kt)("p",null,"Trong Node.js, khi s\u1eed d\u1ee5ng worker threads, m\u1ed7i worker thread s\u1ebd c\xf3 m\u1ed9t bi\u1ebfn to\xe0n c\u1ee5c \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 isMainThread \u0111\u1ec3 x\xe1c \u0111\u1ecbnh xem m\xe3 ngu\u1ed3n hi\u1ec7n t\u1ea1i c\xf3 ch\u1ea1y trong lu\u1ed3ng ch\xednh (main thread) hay trong worker thread."),(0,o.kt)("p",null,"Vi\u1ec7c ki\u1ec3m tra isMainThread trong t\u1ec7p main.js l\xe0 c\xe1ch \u0111\u1ec3 x\xe1c \u0111\u1ecbnh xem m\xe3 ngu\u1ed3n \u0111ang ch\u1ea1y trong lu\u1ed3ng ch\xednh hay kh\xf4ng. Khi b\u1ea1n ch\u1ea1y t\u1ec7p main.js, bi\u1ebfn isMainThread s\u1ebd c\xf3 gi\xe1 tr\u1ecb true, v\xec b\u1ea1n \u0111ang ch\u1ea1y trong lu\u1ed3ng ch\xednh. Do \u0111\xf3, b\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng \u0111i\u1ec1u ki\u1ec7n \u0111\u1ec3 quy\u1ebft \u0111\u1ecbnh c\xe1c ho\u1ea1t \u0111\u1ed9ng c\u1ea7n th\u1ef1c hi\u1ec7n trong lu\u1ed3ng ch\xednh."),(0,o.kt)("p",null,"V\xed d\u1ee5, khi b\u1ea1n t\u1ea1o worker thread b\u1eb1ng c\xe1ch t\u1ea1o \u0111\u1ed1i t\u01b0\u1ee3ng Worker trong lu\u1ed3ng ch\xednh, b\u1ea1n mu\u1ed1n \u0111\u1ea3m b\u1ea3o r\u1eb1ng m\xe3 ngu\u1ed3n trong t\u1ec7p worker.js ch\u1ec9 \u0111\u01b0\u1ee3c ch\u1ea1y trong worker thread, ch\u1ee9 kh\xf4ng ph\u1ea3i trong lu\u1ed3ng ch\xednh. \u0110i\u1ec1u n\xe0y gi\xfap t\xe1ch bi\u1ec7t ho\u1ea1t \u0111\u1ed9ng c\u1ee7a lu\u1ed3ng ch\xednh v\xe0 c\xe1c worker thread."),(0,o.kt)("p",null,"Do \u0111\xf3, ki\u1ec3m tra isMainThread trong main.js gi\xfap b\u1ea1n qu\u1ea3n l\xfd v\xe0 \u0111i\u1ec1u ch\u1ec9nh vi\u1ec7c ch\u1ea1y m\xe3 ngu\u1ed3n theo c\xe1ch th\xedch h\u1ee3p trong m\xf4i tr\u01b0\u1eddng s\u1eed d\u1ee5ng worker threads."))}p.isMDXComponent=!0}}]);