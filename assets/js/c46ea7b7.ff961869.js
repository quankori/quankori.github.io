"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6687],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),a=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=a(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=a(n),g=o,f=m["".concat(l,".").concat(g)]||m[g]||u[g]||s;return n?r.createElement(f,c(c({ref:t},p),{},{components:n})):r.createElement(f,c({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,c=new Array(s);c[0]=g;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[m]="string"==typeof e?e:o,c[1]=i;for(var a=2;a<s;a++)c[a]=n[a];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},4537:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>a});var r=n(7462),o=(n(7294),n(3905));const s={title:"Exception filter"},c=void 0,i={unversionedId:"programming/nestjs/exception-filter",id:"programming/nestjs/exception-filter",title:"Exception filter",description:"Image",source:"@site/docs/programming/nestjs/exception-filter.md",sourceDirName:"programming/nestjs",slug:"/programming/nestjs/exception-filter",permalink:"/docs/programming/nestjs/exception-filter",draft:!1,tags:[],version:"current",frontMatter:{title:"Exception filter"},sidebar:"programming",previous:{title:"Middlewares",permalink:"/docs/programming/nestjs/middlewares"},next:{title:"Pipes",permalink:"/docs/programming/nestjs/pipes"}},l={},a=[{value:"Concept",id:"concept",level:2},{value:"Code",id:"code",level:2}],p={toc:a},m="wrapper";function u(e){let{components:t,...n}=e;return(0,o.kt)(m,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/quankori/quankori.github.io/master/src/images/nestjs/3.png",alt:"Image"})),(0,o.kt)("h2",{id:"concept"},"Concept"),(0,o.kt)("p",null,"Exception filter trong NestJS l\xe0 m\u1ed9t c\u01a1 ch\u1ebf cho ph\xe9p b\u1ea1n x\u1eed l\xfd c\xe1c ngo\u1ea1i l\u1ec7 (exceptions) m\u1ed9t c\xe1ch t\xf9y ch\u1ec9nh v\xe0 \u0111\u1ecbnh h\xecnh c\xe1ch \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n x\u1eed l\xfd l\u1ed7i. Thay v\xec \u0111\u1ec3 c\xe1c ngo\u1ea1i l\u1ec7 lan tr\xe0n ra ngo\xe0i v\xe0 tr\u1edf th\xe0nh l\u1ed7i kh\xf4ng x\u1eed l\xfd, b\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng Exception filter \u0111\u1ec3 b\u1eaft v\xe0 x\u1eed l\xfd ch\xfang theo c\xe1ch m\xe0 b\u1ea1n mu\u1ed1n."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"@Catch")," l\xe0 m\u1ed9t decorator trong NestJS \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 \xe1p d\u1ee5ng Exception filter l\xean m\u1ed9t class (controller class ho\u1eb7c custom filter class). B\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,o.kt)("inlineCode",{parentName:"p"},"@Catch")," \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh lo\u1ea1i ngo\u1ea1i l\u1ec7 m\xe0 filter s\u1ebd x\u1eed l\xfd."),(0,o.kt)("h2",{id:"code"},"Code"),(0,o.kt)("p",null,"T\u1ea1o custom exception filter"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import {\n  ExceptionFilter,\n  Catch,\n  ArgumentsHost,\n  HttpStatus,\n} from "@nestjs/common";\nimport { Request, Response } from "express";\n\n@Catch(CustomException)\nexport class CustomExceptionFilter implements ExceptionFilter {\n  catch(exception: CustomException, host: ArgumentsHost) {\n    const ctx = host.switchToHttp();\n    const response = ctx.getResponse<Response>();\n    const request = ctx.getRequest<Request>();\n\n    const status = HttpStatus.INTERNAL_SERVER_ERROR;\n    const message = exception.message || "Internal server error";\n\n    response.status(status).json({\n      statusCode: status,\n      timestamp: new Date().toISOString(),\n      path: request.url,\n      message: message,\n    });\n  }\n}\n')),(0,o.kt)("p",null,"\xc1p d\u1ee5ng CustomExceptionFilter l\xean m\u1ed9t controller method b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng @UseFilters decorator"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import { Controller, Get, UseFilters } from "@nestjs/common";\nimport { CustomExceptionFilter } from "./custom-exception.filter";\nimport { CustomException } from "./custom.exception";\n\n@Controller("cats")\n@UseFilters(CustomExceptionFilter)\nexport class CatsController {\n  @Get("error")\n  throwError() {\n    throw new CustomException("This is a custom exception.");\n  }\n}\n')),(0,o.kt)("p",null,"\xc1p d\u1ee5ng trong global"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"app.useGlobalFilters(new CustomExceptionFilter());\n")))}u.isMDXComponent=!0}}]);