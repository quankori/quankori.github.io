<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blog/programming/nodejs">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Node.js | Quan Nguyen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://quankori.github.io/blog/programming/nodejs"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Node.js | Quan Nguyen"><meta data-rh="true" name="description" content="Kiến Trúc Cốt Lõi (Core Architecture)"><meta data-rh="true" property="og:description" content="Kiến Trúc Cốt Lõi (Core Architecture)"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://quankori.github.io/blog/programming/nodejs"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/programming/nodejs" hreflang="en"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/programming/nodejs" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://a-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Quan Nguyen" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d2c8af8d.css">
<link rel="preload" href="/assets/js/runtime~main.9e9ccc88.js" as="script">
<link rel="preload" href="/assets/js/main.8db436b3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kori Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">My Note</a></div><div class="navbar__items navbar__items--right"><div class="navbar-search searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://www.linkedin.com/in/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-icon" title="My Github" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">About Me</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/system-design/checklist">System Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/programming/nodejs">Programming Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/programming/nodejs">Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/golang">Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/message-queue">Message Queue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/redis">Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/computer-science">Computer Science</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/programming-design-pattern">Programming Design Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/design-principle">Design Principle</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/english/cheatsheet">English</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Programming Language</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Node.js</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Node.js</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kiến-trúc-cốt-lõi-core-architecture">Kiến Trúc Cốt Lõi (Core Architecture)<a href="#kiến-trúc-cốt-lõi-core-architecture" class="hash-link" aria-label="Direct link to Kiến Trúc Cốt Lõi (Core Architecture)" title="Direct link to Kiến Trúc Cốt Lõi (Core Architecture)">​</a></h2><p>Node.js không phải là một ngôn ngữ lập trình mới, mà là một môi trường thực thi JavaScript xây dựng trên V8 JavaScript engine của Chrome. Kiến trúc của nó được thiết kế để xử lý hiệu quả các tác vụ I/O.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mô-hình-hướng-sự-kiện-và-event-loop">Mô Hình Hướng Sự Kiện và Event Loop<a href="#mô-hình-hướng-sự-kiện-và-event-loop" class="hash-link" aria-label="Direct link to Mô Hình Hướng Sự Kiện và Event Loop" title="Direct link to Mô Hình Hướng Sự Kiện và Event Loop">​</a></h3><p>Trái tim của Node.js là Event Loop. Nó cho phép Node.js thực hiện non-blocking I/O mặc dù JavaScript là đơn luồng (single-threaded).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cách-hoạt-động">Cách hoạt động:<a href="#cách-hoạt-động" class="hash-link" aria-label="Direct link to Cách hoạt động:" title="Direct link to Cách hoạt động:">​</a></h4><ol><li><p><strong>Client gửi yêu cầu</strong>: Khi một yêu cầu đến (ví dụ: đọc file, truy vấn database), Node.js đặt yêu cầu đó vào hàng đợi (queue).</p></li><li><p><strong>Giao cho hệ điều hành</strong>: Node.js không tự mình thực hiện tác vụ I/O. Thay vào đó, nó sử dụng thư viện libuv để giao tác vụ đó cho hệ điều hành (OS). Hệ điều hành có thể sử dụng các cơ chế đa luồng riêng để xử lý hiệu quả.</p></li><li><p><strong>Tiếp tục xử lý</strong>: Trong khi OS đang xử lý tác vụ I/O, Event Loop không bị chặn. Nó tiếp tục quay vòng, kiểm tra xem có sự kiện nào khác cần xử lý không (ví dụ: yêu cầu mới, timer hết hạn).</p></li><li><p><strong>Callback được kích hoạt</strong>: Khi OS hoàn thành tác vụ I/O, nó thông báo cho Node.js. Event Loop nhận được thông báo này và đưa hàm callback tương ứng với tác vụ đã hoàn thành vào Poll Queue (hoặc các queue khác tùy pha).</p></li><li><p>T<strong>hực thi Callback</strong>: Khi Call Stack trống, Event Loop lấy callback từ Poll Queue (hoặc các queue khác) và đẩy vào Call Stack để thực thi.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="các-pha-chính-của-event-loop-theo-libuv">Các Pha Chính của Event Loop (theo libuv):<a href="#các-pha-chính-của-event-loop-theo-libuv" class="hash-link" aria-label="Direct link to Các Pha Chính của Event Loop (theo libuv):" title="Direct link to Các Pha Chính của Event Loop (theo libuv):">​</a></h4><ul><li><p>Timers: Thực thi các callback được lên lịch bởi setTimeout() và setInterval().</p></li><li><p>Pending Callbacks: Thực thi các callback I/O bị trì hoãn đến vòng lặp tiếp theo.</p></li><li><p>Idle, Prepare: Chỉ sử dụng nội bộ.</p></li><li><p>Poll: Truy xuất các sự kiện I/O mới; thực thi các callback liên quan đến I/O (hầu hết các callback, trừ close callbacks, timers, và setImmediate). Node.js có thể chặn ở pha này nếu không có gì khác để làm.</p></li><li><p>Check: Thực thi các callback của setImmediate().</p></li><li><p>Close Callbacks: Thực thi các callback đóng (ví dụ: socket.on(&#x27;close&#x27;, ...)).</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="v8-engine">V8 Engine<a href="#v8-engine" class="hash-link" aria-label="Direct link to V8 Engine" title="Direct link to V8 Engine">​</a></h3><p>V8 là engine JavaScript mã nguồn mở hiệu năng cao của Google, được viết bằng C++. Node.js sử dụng V8 để biên dịch mã JavaScript thành mã máy gốc.</p><ul><li><p><strong>Call Stack</strong>: Nơi các frame thực thi hàm được đẩy vào và lấy ra (LIFO - Last In, First Out).</p></li><li><p><strong>Memory Heap</strong>: Nơi cấp phát bộ nhớ cho các đối tượng và biến. Garbage Collection (GC) diễn ra ở đây.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-system">Module System<a href="#module-system" class="hash-link" aria-label="Direct link to Module System" title="Direct link to Module System">​</a></h3><p>Node.js có hai hệ thống module chính:</p><ul><li><p><strong>CommonJS (CJS)</strong>: Hệ thống module mặc định trong lịch sử Node.js. Sử dụng require() để nhập và module.exports hoặc exports để xuất. Đồng bộ.</p></li><li><p><strong>ES Modules (ESM)</strong>: Chuẩn module chính thức của JavaScript. Sử dụng import và export. Bất đồng bộ. Node.js hỗ trợ ESM thông qua đuôi file .mjs hoặc cấu hình &quot;type&quot;: &quot;module&quot; trong package.json.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="garbage-collection-gc">Garbage Collection (GC)<a href="#garbage-collection-gc" class="hash-link" aria-label="Direct link to Garbage Collection (GC)" title="Direct link to Garbage Collection (GC)">​</a></h2><p>GC là quá trình tự động thu hồi bộ nhớ không còn được sử dụng. V8 sử dụng chiến lược Generational Collection:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="young-generation-thế-hệ-trẻ">Young Generation (Thế hệ trẻ):<a href="#young-generation-thế-hệ-trẻ" class="hash-link" aria-label="Direct link to Young Generation (Thế hệ trẻ):" title="Direct link to Young Generation (Thế hệ trẻ):">​</a></h3><p>Hầu hết các đối tượng được tạo ra ở đây.</p><p>Không gian nhỏ, chia thành &quot;from-space&quot; và &quot;to-space&quot;.</p><p>Sử dụng thuật toán Scavenge (Copying Collector):</p><ul><li><p>Khi &quot;from-space&quot; đầy, GC bắt đầu.</p></li><li><p>Nó quét các đối tượng còn sống trong &quot;from-space&quot;.</p></li><li><p>Các đối tượng còn sống được sao chép sang &quot;to-space&quot;.</p></li><li><p>Các đối tượng đã sống sót qua một (hoặc hai) lần Scavenge sẽ được &quot;thăng cấp&quot; lên Old Generation.</p></li><li><p>Sau khi sao chép xong, &quot;from-space&quot; và &quot;to-space&quot; đổi vai trò cho nhau.</p></li></ul><p>Quá trình này nhanh nhưng tốn gấp đôi bộ nhớ (do cần 2 space).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="old-generation-thế-hệ-già">Old Generation (Thế hệ già):<a href="#old-generation-thế-hệ-già" class="hash-link" aria-label="Direct link to Old Generation (Thế hệ già):" title="Direct link to Old Generation (Thế hệ già):">​</a></h3><p>Chứa các đối tượng đã sống sót qua Young Generation hoặc các đối tượng lớn.</p><p>Sử dụng thuật toán Mark-Sweep &amp; Mark-Compact:</p><ul><li><p>Marking (Đánh dấu): Bắt đầu từ các đối tượng gốc (root objects - ví dụ: biến toàn cục, stack), GC duyệt qua đồ thị đối tượng và đánh dấu tất cả các đối tượng có thể truy cập được (còn sống).</p></li><li><p>Sweeping (Quét): GC quét qua toàn bộ Heap và thu hồi bộ nhớ của các đối tượng không được đánh dấu (rác).</p></li><li><p>Compacting (Nén - tùy chọn): Sau khi quét, bộ nhớ có thể bị phân mảnh. GC di chuyển các đối tượng còn sống lại gần nhau để giảm phân mảnh và cải thiện hiệu quả cấp phát bộ nhớ sau này. Quá trình này tốn thời gian hơn.</p></li></ul><p>GC ở Old Generation diễn ra ít thường xuyên hơn nhưng tốn thời gian hơn (&quot;stop-the-world&quot; - tạm dừng thực thi JavaScript).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tối-ưu-hóa-hiệu-năng-performance-optimization">Tối Ưu Hóa Hiệu Năng (Performance Optimization)<a href="#tối-ưu-hóa-hiệu-năng-performance-optimization" class="hash-link" aria-label="Direct link to Tối Ưu Hóa Hiệu Năng (Performance Optimization)" title="Direct link to Tối Ưu Hóa Hiệu Năng (Performance Optimization)">​</a></h2><p><strong>Sử dụng Non-blocking I/O</strong>: Tận dụng tối đa bản chất bất đồng bộ của Node.js. Sử dụng async/await hoặc Promises thay vì các hàm đồng bộ (ví dụ: fs.readFileSync).</p><p><strong>Streams</strong>: Sử dụng streams (fs.createReadStream, fs.createWriteStream) để xử lý dữ liệu lớn mà không cần tải toàn bộ vào bộ nhớ.</p><p><strong>Caching</strong>: Lưu trữ các kết quả tính toán hoặc dữ liệu thường xuyên truy cập (ví dụ: sử dụng Redis, Memcached hoặc caching trong bộ nhớ).</p><p>Tối ưu hóa Code:</p><ul><li><p>Giảm các vòng lặp lồng nhau phức tạp.</p></li><li><p>Sử dụng các cấu trúc dữ liệu hiệu quả (ví dụ: Map, Set).</p></li><li><p>Tránh cấp phát bộ nhớ không cần thiết trong các vòng lặp hoặc hàm chạy thường xuyên.</p></li></ul><p><strong>Worker Threads</strong>: Sử dụng worker_threads để chạy các tác vụ nặng về CPU (ví dụ: mã hóa, xử lý ảnh) trên các luồng riêng biệt mà không chặn Event Loop chính.</p><p><strong>Profiling &amp; Monitoring</strong>: Sử dụng các công cụ như node --inspect, Chrome DevTools, clinic.js, New Relic, Datadog để xác định các điểm nghẽn cổ chai (bottlenecks) và rò rỉ bộ nhớ (memory leaks).</p><p>Tối ưu hóa GC:</p><ul><li><p>Tránh tạo quá nhiều đối tượng tồn tại ngắn hạn.</p></li><li><p>Sử dụng Object Pooling nếu hợp lý.</p></li></ul><p><strong>Sử dụng phiên bản Node.js và V8 mới nhất</strong>: Thường xuyên có các cải tiến về hiệu năng.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="callback-callback-hell-và-asyncawait-chuyên-sâu">Callback, Callback Hell, và Async/Await Chuyên Sâu<a href="#callback-callback-hell-và-asyncawait-chuyên-sâu" class="hash-link" aria-label="Direct link to Callback, Callback Hell, và Async/Await Chuyên Sâu" title="Direct link to Callback, Callback Hell, và Async/Await Chuyên Sâu">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="callbacks">Callbacks<a href="#callbacks" class="hash-link" aria-label="Direct link to Callbacks" title="Direct link to Callbacks">​</a></h3><p>Callback là một hàm được truyền vào một hàm khác như một đối số, và được gọi lại (executed) sau khi một tác vụ nào đó hoàn thành (thường là tác vụ bất đồng bộ).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="callback-hell-pyramid-of-doom">Callback Hell (Pyramid of Doom)<a href="#callback-hell-pyramid-of-doom" class="hash-link" aria-label="Direct link to Callback Hell (Pyramid of Doom)" title="Direct link to Callback Hell (Pyramid of Doom)">​</a></h3><p>Khi có nhiều tác vụ bất đồng bộ phụ thuộc lẫn nhau, việc lồng các callback vào nhau dẫn đến mã khó đọc, khó bảo trì và dễ lỗi.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Example of Callback Hell (Conceptual)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">getData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">processData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">processed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">saveData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          processed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">logResult</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;All done!&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Logging failed:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Saving failed:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Processing failed:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Getting data failed:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="promises">Promises<a href="#promises" class="hash-link" aria-label="Direct link to Promises" title="Direct link to Promises">​</a></h3><p>Promises cung cấp một cách cấu trúc mã bất đồng bộ tốt hơn, tránh Callback Hell bằng cách cho phép &quot;chaining&quot; (nối chuỗi) các hành động .then() và xử lý lỗi tập trung qua .catch().</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="asyncawait-chuyên-sâu">Async/Await Chuyên Sâu<a href="#asyncawait-chuyên-sâu" class="hash-link" aria-label="Direct link to Async/Await Chuyên Sâu" title="Direct link to Async/Await Chuyên Sâu">​</a></h3><p>async/await là cú pháp được xây dựng trên Promises, giúp viết mã bất đồng bộ trông giống như mã đồng bộ, dễ đọc và dễ hiểu hơn rất nhiều.</p><ul><li><p>async function: Khai báo một hàm luôn trả về một Promise. Nếu hàm trả về một giá trị không phải Promise, nó sẽ tự động được bọc trong một Promise đã được giải quyết (resolved).</p></li><li><p>await operator: Chỉ có thể sử dụng bên trong một async function. Nó tạm dừng việc thực thi của async function cho đến khi Promise theo sau await được giải quyết (settled - resolved hoặc rejected).</p><ul><li><p>Nếu Promise được resolved, await trả về giá trị đã resolved.</p></li><li><p>Nếu Promise bị rejected, await ném ra (throws) lỗi đã rejected.</p></li></ul></li><li><p>Cách hoạt động bên dưới (Under the Hood):</p></li></ul><p>async/await thực chất là &quot;syntactic sugar&quot; (cú pháp tiện lợi) cho Generators và Promises. Khi V8 (hoặc trình biên dịch TypeScript/Babel) gặp async function, nó biến đổi hàm đó thành một dạng state machine (máy trạng thái) sử dụng generators (function<!-- -->*<!-- --> và yield).</p><ol><li><p>Khi async function được gọi, nó trả về một Promise ngay lập tức.</p></li><li><p>Khi gặp await somePromise, hàm tạm dừng (yield).</p></li><li><p>Khi somePromise được giải quyết, Event Loop sẽ lên lịch để hàm tiếp tục thực thi từ điểm dừng. Giá trị resolved được trả về từ yield.</p></li><li><p>Nếu somePromise bị reject, lỗi sẽ được ném ra tại điểm await, có thể được bắt bởi try...catch.</p></li><li><p>Khi hàm thực thi xong (return hoặc hết code), Promise mà nó trả về ban đầu sẽ được resolve với giá trị return. Nếu có lỗi không được bắt, Promise sẽ bị reject.</p></li></ol><p>Sự tương tác với Event Loop: await không chặn Event Loop. Nó chỉ tạm dừng việc thực thi của chính hàm async đó. Event Loop vẫn tiếp tục chạy và xử lý các sự kiện khác trong khi chờ Promise được giải quyết. Khi Promise giải quyết, việc tiếp tục thực thi hàm async được đưa vào hàng đợi (Microtask Queue, ưu tiên hơn Macrotask Queue/Callback Queue) và sẽ chạy ngay khi Call Stack trống.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaling-trong-nodejs">Scaling trong Node.js<a href="#scaling-trong-nodejs" class="hash-link" aria-label="Direct link to Scaling trong Node.js" title="Direct link to Scaling trong Node.js">​</a></h3><p>Node.js chạy trên một luồng chính duy nhất. Để tận dụng các hệ thống đa lõi và xử lý tải cao, cần có các chiến lược scaling:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="child-processes-child_process-module">Child Processes (child_process module)<a href="#child-processes-child_process-module" class="hash-link" aria-label="Direct link to Child Processes (child_process module)" title="Direct link to Child Processes (child_process module)">​</a></h3><p>Cho phép tạo ra các tiến trình (process) con riêng biệt. Mỗi tiến trình con có bộ nhớ và Event Loop riêng.</p><p>spawn(): Tốt cho luồng dữ liệu lớn (streams).</p><p>exec(): Tốt cho chạy các lệnh shell, có buffer.</p><p>execFile(): Tương tự exec nhưng chạy file thực thi trực tiếp, an toàn hơn.</p><p>fork(): Một dạng đặc biệt của spawn, tạo ra một tiến trình Node.js mới và cho phép giao tiếp hai chiều qua IPC (Inter-Process Communication). Thường dùng với cluster.</p><p>Hữu ích cho việc chạy các script bên ngoài hoặc tách biệt các phần của ứng dụng.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="worker-threads-worker_threads-module">Worker Threads (worker_threads module)<a href="#worker-threads-worker_threads-module" class="hash-link" aria-label="Direct link to Worker Threads (worker_threads module)" title="Direct link to Worker Threads (worker_threads module)">​</a></h3><p>Cho phép chạy mã JavaScript song song trên các luồng (thread) riêng biệt trong cùng một tiến trình. Các luồng chia sẻ bộ nhớ hiệu quả hơn so với các tiến trình riêng biệt (qua SharedArrayBuffer hoặc postMessage).</p><p>Rất lý tưởng cho các tác vụ CPU-bound (tính toán nặng) mà không muốn chặn Event Loop chính.</p><p>Không nên dùng cho các tác vụ I/O-bound (Node.js đã tối ưu cho việc này bằng non-blocking I/O trên luồng chính).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-cluster-module">Cluster (cluster module)<a href="#cluster-cluster-module" class="hash-link" aria-label="Direct link to Cluster (cluster module)" title="Direct link to Cluster (cluster module)">​</a></h3><p>Cho phép tạo ra nhiều tiến trình Node.js (workers) cùng lắng nghe trên một cổng mạng (port).</p><p>Một Master Process được tạo ra đầu tiên.</p><p>Master Process sử dụng cluster.fork() để tạo ra các Worker Processes.</p><p>Master Process quản lý việc phân phối các kết nối đến (incoming connections) cho các Worker Processes (thường theo kiểu Round-robin).</p><p>Mỗi Worker Process là một tiến trình Node.js độc lập với Event Loop riêng.</p><p>Giúp tận dụng tối đa các lõi CPU của máy chủ để xử lý nhiều yêu cầu đồng thời. Đây là cách phổ biến nhất để scale ứng dụng Node.js trên một máy chủ duy nhất.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rxjs-và-lập-trình-phản-ứng-reactive-programming-chuyên-sâu">RxJS và Lập Trình Phản ứng (Reactive Programming) Chuyên Sâu<a href="#rxjs-và-lập-trình-phản-ứng-reactive-programming-chuyên-sâu" class="hash-link" aria-label="Direct link to RxJS và Lập Trình Phản ứng (Reactive Programming) Chuyên Sâu" title="Direct link to RxJS và Lập Trình Phản ứng (Reactive Programming) Chuyên Sâu">​</a></h2><p>Ngoài Callbacks, Promises và Async/Await, RxJS (Reactive Extensions for JavaScript) cung cấp một mô hình mạnh mẽ khác để xử lý các luồng dữ liệu và sự kiện bất đồng bộ: Lập trình phản ứng.</p><p>RxJS xem các sự kiện (click chuột, dữ liệu từ API, tin nhắn WebSocket, timer,...) như những luồng dữ liệu (streams) có thể quan sát được theo thời gian.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="các-khái-niệm-cốt-lõi">Các Khái Niệm Cốt Lõi<a href="#các-khái-niệm-cốt-lõi" class="hash-link" aria-label="Direct link to Các Khái Niệm Cốt Lõi" title="Direct link to Các Khái Niệm Cốt Lõi">​</a></h3><ul><li>Observable: Đại diện cho một tập hợp các giá trị hoặc sự kiện trong tương lai (một stream). Observable là lazy (chỉ thực thi khi có ai đó đăng ký - subscribe) và có thể phát ra nhiều giá trị theo thời gian (0 đến vô hạn). Nó cũng có thể bị hủy (cancel).</li></ul><p>Khác với Promise: Promise chỉ xử lý một giá trị duy nhất (resolved hoặc rejected) và không thể hủy bỏ sau khi đã bắt đầu.</p><ul><li>Observer: Là một đối tượng có các hàm callback để lắng nghe các giá trị được phát ra bởi Observable:</li></ul><p>next(value): Được gọi mỗi khi Observable phát ra một giá trị mới.</p><p>error(err): Được gọi nếu Observable gặp lỗi. Stream kết thúc.</p><p>complete(): Được gọi khi Observable hoàn thành việc phát giá trị và không còn giá trị nào nữa. Stream kết thúc.</p><ul><li><p>Subscription: Đại diện cho việc thực thi một Observable. Nó được trả về khi bạn gọi .subscribe(). Quan trọng nhất, nó có phương thức .unsubscribe() để hủy bỏ việc lắng nghe và giải phóng tài nguyên, tránh rò rỉ bộ nhớ.</p></li><li><p>Operators: Là các hàm thuần túy (pure functions) cho phép bạn thao tác với các stream dữ liệu một cách khai báo (declarative). RxJS cung cấp một bộ sưu tập lớn các operators:</p><ul><li><p>Creation Operators: Tạo Observable từ các nguồn khác nhau (of, from, interval, timer, fromEvent).</p></li><li><p>Transformation Operators: Biến đổi giá trị trong stream (map, pluck, scan, mergeMap/flatMap, switchMap, concatMap).</p></li><li><p>Filtering Operators: Lọc các giá trị không mong muốn (filter, take, skip, debounceTime, distinctUntilChanged).</p></li><li><p>Combination Operators: Kết hợp nhiều Observable lại với nhau (combineLatest, merge, zip, forkJoin).</p></li><li><p>Error Handling Operators: Xử lý lỗi trong stream (catchError, retry).</p></li><li><p>Utility Operators: Các toán tử tiện ích khác (tap - để thực hiện side effect, delay).</p></li></ul></li><li><p>Subject: Một loại đặc biệt hoạt động như cả Observable và Observer. Nó có thể phát (multicast) giá trị cho nhiều Observers cùng lúc. Hữu ích trong việc chia sẻ trạng thái hoặc sự kiện. Các loại phổ biến:</p></li><li><p>Subject: Cơ bản nhất, không có giá trị ban đầu.</p><ul><li><p>BehaviorSubject: Yêu cầu giá trị ban đầu và phát giá trị cuối cùng cho subscriber mới.</p></li><li><p>ReplaySubject: Ghi lại và phát lại một số lượng giá trị trước đó cho subscriber mới.</p></li><li><p>AsyncSubject: Chỉ phát giá trị cuối cùng khi stream complete.</p></li></ul></li><li><p>Scheduler: Kiểm soát thời điểm và cách thức các subscription bắt đầu và các thông báo được gửi đi. Hữu ích cho việc điều phối concurrency (ví dụ: asyncScheduler, queueScheduler).</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tại-sao-dùng-rxjs-trong-nodejs">Tại Sao Dùng RxJS trong Node.js?<a href="#tại-sao-dùng-rxjs-trong-nodejs" class="hash-link" aria-label="Direct link to Tại Sao Dùng RxJS trong Node.js?" title="Direct link to Tại Sao Dùng RxJS trong Node.js?">​</a></h3><p>Mặc dù Node.js đã có cơ chế non-blocking I/O hiệu quả, RxJS vẫn mang lại lợi ích trong các kịch bản phức tạp:</p><ul><li><p>Quản lý luồng sự kiện phức tạp: Xử lý các luồng sự kiện liên tục như WebSockets, dữ liệu cảm biến IoT, hoặc tương tác người dùng phức tạp.</p></li><li><p>Kết hợp và điều phối nhiều tác vụ bất đồng bộ: Khi bạn cần kết hợp kết quả từ nhiều API calls, database queries, hoặc các sự kiện hệ thống theo những cách phức tạp (ví dụ: chờ tất cả hoàn thành, lấy cái đầu tiên, xử lý song song có giới hạn).</p></li><li><p>Rate Limiting, Debouncing, Throttling: Dễ dàng kiểm soát tần suất các hành động được thực thi (ví dụ: giới hạn số lần gọi API, trì hoãn xử lý input người dùng).</p></li><li><p>Quản lý State phức tạp: Sử dụng BehaviorSubject hoặc ReplaySubject để quản lý và chia sẻ trạng thái trong ứng dụng.</p></li><li><p>Code dễ đọc hơn cho logic bất đồng bộ phức tạp: Sử dụng các operators giúp diễn đạt các luồng xử lý phức tạp một cách rõ ràng và khai báo hơn so với việc lồng nhiều callback hoặc promise chain.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="so-sánh-với-promisesasyncawait">So Sánh với Promises/Async/Await<a href="#so-sánh-với-promisesasyncawait" class="hash-link" aria-label="Direct link to So Sánh với Promises/Async/Await" title="Direct link to So Sánh với Promises/Async/Await">​</a></h3><p><strong>Promises/Async/Await</strong>: Tuyệt vời cho các tác vụ bất đồng bộ trả về một giá trị duy nhất (ví dụ: gọi API, đọc file). Cú pháp async/await làm cho code trông giống đồng bộ, rất dễ đọc cho các luồng tuần tự.</p><p><strong>RxJS</strong>: Mạnh mẽ hơn khi xử lý các luồng (streams) có thể phát ra nhiều giá trị theo thời gian, cần hủy bỏ (cancellation), hoặc yêu cầu các phép biến đổi/kết hợp luồng phức tạp. Đường cong học tập (learning curve) của RxJS cao hơn.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="chuyên-sâu-về-scope-trong-javascript-và-typescript">Chuyên Sâu về Scope trong JavaScript (và TypeScript)<a href="#chuyên-sâu-về-scope-trong-javascript-và-typescript" class="hash-link" aria-label="Direct link to Chuyên Sâu về Scope trong JavaScript (và TypeScript)" title="Direct link to Chuyên Sâu về Scope trong JavaScript (và TypeScript)">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="global-scope">Global Scope<a href="#global-scope" class="hash-link" aria-label="Direct link to Global Scope" title="Direct link to Global Scope">​</a></h4><p>Biến được khai báo bên ngoài bất kỳ hàm hay block nào sẽ thuộc Global Scope. Trong môi trường Node.js, biến global thực sự được gắn vào đối tượng global. Trong trình duyệt là window. Nên hạn chế tối đa việc sử dụng biến global.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="function-scope">Function Scope<a href="#function-scope" class="hash-link" aria-label="Direct link to Function Scope" title="Direct link to Function Scope">​</a></h4><p>Biến được khai báo bằng var bên trong một hàm chỉ có thể truy cập được bên trong hàm đó (và các hàm lồng bên trong).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="block-scope">Block Scope<a href="#block-scope" class="hash-link" aria-label="Direct link to Block Scope" title="Direct link to Block Scope">​</a></h4><p>Biến được khai báo bằng let và const bên trong một block ({ ... } - ví dụ: trong if, for, hoặc block đơn lẻ) chỉ có thể truy cập được bên trong block đó. Đây là scope được ưa chuộng hơn Function Scope vì nó giúp giới hạn phạm vi của biến chặt chẽ hơn.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="lexical-scope-static-scope">Lexical Scope (Static Scope)<a href="#lexical-scope-static-scope" class="hash-link" aria-label="Direct link to Lexical Scope (Static Scope)" title="Direct link to Lexical Scope (Static Scope)">​</a></h4><p>JavaScript sử dụng Lexical Scope, nghĩa là scope của một hàm được xác định tại thời điểm hàm đó được định nghĩa, chứ không phải tại thời điểm nó được gọi. Một hàm lồng bên trong (inner function) có thể truy cập các biến của hàm cha (outer function) ngay cả khi hàm cha đã thực thi xong. Đây chính là cơ chế tạo ra Closures.</p><p><strong>Closure</strong>: Là sự kết hợp của một hàm và môi trường lexical (lexical environment) nơi hàm đó được khai báo. Môi trường này bao gồm tất cả các biến cục bộ có hiệu lực tại thời điểm hàm được tạo ra. Closure cho phép hàm &quot;nhớ&quot; môi trường mà nó được tạo ra.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="scope-chain">Scope Chain<a href="#scope-chain" class="hash-link" aria-label="Direct link to Scope Chain" title="Direct link to Scope Chain">​</a></h4><p>Khi truy cập một biến, JavaScript engine sẽ tìm kiếm biến đó theo chuỗi scope (Scope Chain):</p><ol><li><p>Bắt đầu từ scope hiện tại (local scope).</p></li><li><p>Nếu không tìm thấy, tìm lên scope của hàm cha (outer scope).</p></li><li><p>Tiếp tục tìm lên các scope cha tiếp theo.</p></li><li><p>Cuối cùng, tìm trong Global Scope.</p></li><li><p>Nếu không tìm thấy ở đâu cả, sẽ báo lỗi ReferenceError.</p></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/system-design/database"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Database</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/programming/golang"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Golang</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#kiến-trúc-cốt-lõi-core-architecture" class="table-of-contents__link toc-highlight">Kiến Trúc Cốt Lõi (Core Architecture)</a><ul><li><a href="#mô-hình-hướng-sự-kiện-và-event-loop" class="table-of-contents__link toc-highlight">Mô Hình Hướng Sự Kiện và Event Loop</a></li><li><a href="#v8-engine" class="table-of-contents__link toc-highlight">V8 Engine</a></li><li><a href="#module-system" class="table-of-contents__link toc-highlight">Module System</a></li></ul></li><li><a href="#garbage-collection-gc" class="table-of-contents__link toc-highlight">Garbage Collection (GC)</a><ul><li><a href="#young-generation-thế-hệ-trẻ" class="table-of-contents__link toc-highlight">Young Generation (Thế hệ trẻ):</a></li><li><a href="#old-generation-thế-hệ-già" class="table-of-contents__link toc-highlight">Old Generation (Thế hệ già):</a></li></ul></li><li><a href="#tối-ưu-hóa-hiệu-năng-performance-optimization" class="table-of-contents__link toc-highlight">Tối Ưu Hóa Hiệu Năng (Performance Optimization)</a></li><li><a href="#callback-callback-hell-và-asyncawait-chuyên-sâu" class="table-of-contents__link toc-highlight">Callback, Callback Hell, và Async/Await Chuyên Sâu</a><ul><li><a href="#callbacks" class="table-of-contents__link toc-highlight">Callbacks</a></li><li><a href="#callback-hell-pyramid-of-doom" class="table-of-contents__link toc-highlight">Callback Hell (Pyramid of Doom)</a></li><li><a href="#promises" class="table-of-contents__link toc-highlight">Promises</a></li><li><a href="#asyncawait-chuyên-sâu" class="table-of-contents__link toc-highlight">Async/Await Chuyên Sâu</a></li><li><a href="#scaling-trong-nodejs" class="table-of-contents__link toc-highlight">Scaling trong Node.js</a></li><li><a href="#child-processes-child_process-module" class="table-of-contents__link toc-highlight">Child Processes (child_process module)</a></li><li><a href="#worker-threads-worker_threads-module" class="table-of-contents__link toc-highlight">Worker Threads (worker_threads module)</a></li><li><a href="#cluster-cluster-module" class="table-of-contents__link toc-highlight">Cluster (cluster module)</a></li></ul></li><li><a href="#rxjs-và-lập-trình-phản-ứng-reactive-programming-chuyên-sâu" class="table-of-contents__link toc-highlight">RxJS và Lập Trình Phản ứng (Reactive Programming) Chuyên Sâu</a><ul><li><a href="#các-khái-niệm-cốt-lõi" class="table-of-contents__link toc-highlight">Các Khái Niệm Cốt Lõi</a></li><li><a href="#tại-sao-dùng-rxjs-trong-nodejs" class="table-of-contents__link toc-highlight">Tại Sao Dùng RxJS trong Node.js?</a></li><li><a href="#so-sánh-với-promisesasyncawait" class="table-of-contents__link toc-highlight">So Sánh với Promises/Async/Await</a></li></ul></li><li><a href="#chuyên-sâu-về-scope-trong-javascript-và-typescript" class="table-of-contents__link toc-highlight">Chuyên Sâu về Scope trong JavaScript (và TypeScript)</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/icon.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="40" height="40"><img src="/img/icon.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="40" height="40"></a></div><div class="footer__copyright">Copyright © 2025 Quan Kori</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9e9ccc88.js"></script>
<script src="/assets/js/main.8db436b3.js"></script>
</body>
</html>