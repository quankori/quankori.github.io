<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blog/programming/message-queue">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Message Queue | Quan Nguyen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://quankori.github.io/blog/programming/message-queue"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Message Queue | Quan Nguyen"><meta data-rh="true" name="description" content="Kiến Trúc Cốt Lõi"><meta data-rh="true" property="og:description" content="Kiến Trúc Cốt Lõi"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://quankori.github.io/blog/programming/message-queue"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/programming/message-queue" hreflang="en"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/programming/message-queue" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://a-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Quan Nguyen" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d2c8af8d.css">
<link rel="preload" href="/assets/js/runtime~main.9e9ccc88.js" as="script">
<link rel="preload" href="/assets/js/main.8db436b3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kori Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">My Note</a></div><div class="navbar__items navbar__items--right"><div class="navbar-search searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://www.linkedin.com/in/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-icon" title="My Github" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">About Me</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/system-design/checklist">System Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/programming/nodejs">Programming Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/nodejs">Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/golang">Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/programming/message-queue">Message Queue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/redis">Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/computer-science">Computer Science</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/programming-design-pattern">Programming Design Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/design-principle">Design Principle</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/english/cheatsheet">English</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Programming Language</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Message Queue</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Message Queue</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kiến-trúc-cốt-lõi">Kiến Trúc Cốt Lõi<a href="#kiến-trúc-cốt-lõi" class="hash-link" aria-label="Direct link to Kiến Trúc Cốt Lõi" title="Direct link to Kiến Trúc Cốt Lõi">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="apache-kafka-nền-tảng-truyền-dữ-liệu-phân-tán-distributed-streaming-platform">Apache Kafka: Nền Tảng Truyền Dữ Liệu Phân Tán (Distributed Streaming Platform)<a href="#apache-kafka-nền-tảng-truyền-dữ-liệu-phân-tán-distributed-streaming-platform" class="hash-link" aria-label="Direct link to Apache Kafka: Nền Tảng Truyền Dữ Liệu Phân Tán (Distributed Streaming Platform)" title="Direct link to Apache Kafka: Nền Tảng Truyền Dữ Liệu Phân Tán (Distributed Streaming Platform)">​</a></h4><p>Kafka không hoàn toàn là một message queue truyền thống. Nó được thiết kế như một log cam kết phân tán (distributed commit log) hoặc một nền tảng streaming.</p><ul><li><p>Topics: Dữ liệu trong Kafka được tổ chức thành các topics. Bạn có thể hình dung topic như một danh mục hoặc một feed mà producer gửi tin nhắn vào.</p></li><li><p>Partitions: Mỗi topic được chia thành một hoặc nhiều partitions. Partition là một log chỉ cho phép ghi nối tiếp (append-only log), có thứ tự và bất biến. Việc chia partition cho phép Kafka song song hóa việc xử lý và lưu trữ dữ liệu trên nhiều máy chủ (brokers). Thứ tự tin nhắn chỉ được đảm bảo trong phạm vi một partition.</p></li><li><p>Offsets: Mỗi tin nhắn trong một partition có một định danh tuần tự duy nhất gọi là offset. Offset xác định vị trí của tin nhắn trong partition log.</p></li><li><p>Brokers: Các máy chủ Kafka được gọi là brokers. Chúng chịu trách nhiệm lưu trữ dữ liệu (partitions), xử lý yêu cầu từ producer và consumer. Một cụm Kafka (Kafka cluster) bao gồm nhiều brokers.</p></li><li><p>Producers: Các ứng dụng gửi (publish) tin nhắn đến Kafka topics. Producer có thể chọn partition cụ thể để gửi tin nhắn đến hoặc để Kafka quyết định dựa trên key của tin nhắn hoặc theo cơ chế round-robin.</p></li><li><p>Consumers: Các ứng dụng đọc (subscribe) tin nhắn từ Kafka topics. Consumers thường thuộc về một consumer group. Mỗi partition chỉ được đọc bởi một consumer duy nhất trong một group tại một thời điểm, cho phép xử lý song song và cân bằng tải. Consumers tự quản lý offset của tin nhắn cuối cùng đã đọc, cho phép chúng đọc lại dữ liệu hoặc bắt đầu từ một điểm cụ thể.</p></li><li><p>Retention: Kafka lưu giữ tin nhắn trong một khoảng thời gian cấu hình được (ví dụ: 7 ngày) hoặc cho đến khi đạt kích thước giới hạn, bất kể tin nhắn đã được đọc hay chưa. Điều này làm cho Kafka phù hợp với các kịch bản cần xử lý lại dữ liệu.</p></li></ul><p>Điểm mạnh của Kafka: Thông lượng cực cao, khả năng mở rộng tốt, lưu trữ bền vững, phù hợp cho streaming data và event sourcing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rabbitmq-message-broker-truyền-thống-amqp">RabbitMQ: Message Broker Truyền Thống (AMQP)<a href="#rabbitmq-message-broker-truyền-thống-amqp" class="hash-link" aria-label="Direct link to RabbitMQ: Message Broker Truyền Thống (AMQP)" title="Direct link to RabbitMQ: Message Broker Truyền Thống (AMQP)">​</a></h4><p>RabbitMQ là một message broker trưởng thành, triển khai giao thức AMQP (Advanced Message Queuing Protocol) và hỗ trợ các giao thức khác như MQTT, STOMP.</p><ul><li><p>Exchanges: Producers không gửi tin nhắn trực tiếp đến queues. Thay vào đó, chúng gửi đến exchanges. Exchange chịu trách nhiệm định tuyến (routing) tin nhắn đến các queues dựa trên các quy tắc (routing keys, bindings, headers). Các loại exchange phổ biến:</p></li><li><p>direct: Gửi tin nhắn đến queue có binding key khớp chính xác với routing key của tin nhắn.</p></li><li><p>topic: Gửi tin nhắn đến queue có binding pattern khớp với routing key (hỗ trợ wildcard <!-- -->*<!-- --> và #).</p></li><li><p>fanout: Gửi tin nhắn đến tất cả các queues được binding với nó, bỏ qua routing key.</p></li><li><p>headers: Định tuyến dựa trên header attributes của tin nhắn thay vì routing key.</p></li><li><p>Queues: Nơi lưu trữ tin nhắn chờ được xử lý bởi consumers.</p></li><li><p>Bindings: Quy tắc liên kết giữa exchange và queue. Binding định nghĩa cách tin nhắn từ một exchange được chuyển đến một queue cụ thể.</p></li><li><p>Producers: Gửi tin nhắn đến một exchange với một routing key cụ thể.</p></li><li><p>Consumers: Đọc tin nhắn từ một queue cụ thể. RabbitMQ thường sử dụng mô hình push, broker chủ động đẩy tin nhắn đến consumer đã đăng ký. Consumer gửi lại xác nhận (acknowledgement - ack) sau khi xử lý xong tin nhắn. Nếu không nhận được ack, RabbitMQ sẽ giữ lại tin nhắn (hoặc gửi lại cho consumer khác).</p></li><li><p>Message Lifecycle: Tin nhắn thường bị xóa khỏi queue sau khi được consumer xử lý thành công và gửi ack.</p></li></ul><p>Điểm mạnh của RabbitMQ: Định tuyến linh hoạt, hỗ trợ nhiều giao thức, đảm bảo gửi tin nhắn (delivery guarantees), mô hình request/response dễ triển khai, phù hợp cho task queues và decoupling services.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="so-sánh-chi-tiết">So Sánh Chi Tiết<a href="#so-sánh-chi-tiết" class="hash-link" aria-label="Direct link to So Sánh Chi Tiết" title="Direct link to So Sánh Chi Tiết">​</a></h2><table><thead><tr><th>Tính Năng</th><th>Kafka</th><th>RabbitMQ</th></tr></thead><tbody><tr><td>Kiến trúc</td><td>Log phân tán (Distributed Log)</td><td>Message Broker (AMQP)</td></tr><tr><td>Mô hình Consumer</td><td>Pull (Consumer kéo dữ liệu)</td><td>Push (Broker đẩy dữ liệu)</td></tr><tr><td>Thứ tự tin nhắn</td><td>Đảm bảo trong phạm vi 1 partition</td><td>Đảm bảo trong phạm vi 1 queue (với 1 consumer)</td></tr><tr><td>Lưu trữ tin nhắn</td><td>Dựa trên thời gian/kích thước (Bền vững)</td><td>Dựa trên acknowledgement (Thường là tạm thời)</td></tr><tr><td>Thông lượng</td><td>Rất cao (Triệu msg/s)</td><td>Cao (Chục đến trăm nghìn msg/s)</td></tr><tr><td>Độ trễ</td><td>Cao hơn một chút (do batching)</td><td>Thấp hơn (cho các tác vụ đơn giản)</td></tr><tr><td>Định tuyến</td><td>Đơn giản (Topic -&gt; Partition)</td><td>Rất linh hoạt (Exchanges, Bindings)</td></tr><tr><td>Giao thức</td><td>Binary qua TCP</td><td>AMQP, MQTT, STOMP</td></tr><tr><td>Đảm bảo gửi</td><td>At-least-once, Exactly-once (khó hơn)</td><td>At-most-once, At-least-once, (Exactly-once khó)</td></tr><tr><td>Trường hợp dùng</td><td>Streaming, Log Aggregation, Event Sourcing</td><td>Task Queues, RPC, Decoupling Services</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xử-lý-tải-cao-hàng-ngàn-requestgiây">Xử Lý Tải Cao (Hàng Ngàn Request/giây)<a href="#xử-lý-tải-cao-hàng-ngàn-requestgiây" class="hash-link" aria-label="Direct link to Xử Lý Tải Cao (Hàng Ngàn Request/giây)" title="Direct link to Xử Lý Tải Cao (Hàng Ngàn Request/giây)">​</a></h2><p>Cả hai hệ thống đều có thể xử lý tải cao, nhưng cách tiếp cận và điểm nghẽn tiềm ẩn khác nhau.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kafka">Kafka<a href="#kafka" class="hash-link" aria-label="Direct link to Kafka" title="Direct link to Kafka">​</a></h4><p><strong>Khả năng mở rộng</strong>: Kafka được thiết kế để mở rộng theo chiều ngang. Bạn có thể tăng thông lượng bằng cách:</p><ul><li><p>Thêm Brokers: Phân tán tải lưu trữ và xử lý trên nhiều máy chủ hơn.</p></li><li><p>Tăng số Partitions: Cho phép nhiều consumer trong một group đọc song song từ cùng một topic. Số lượng partition là giới hạn trên cho mức độ song song của một consumer group.</p></li></ul><p><strong>Ảnh hưởng</strong>: Với hàng ngàn request/giây, Kafka thường hoạt động tốt nếu:</p><ul><li><p>Partitioning Strategy: Key của tin nhắn được chọn tốt để phân phối đều dữ liệu trên các partitions, tránh &quot;hot partitions&quot;.</p></li><li><p>Consumer Parallelism: Số lượng consumer instances trong một group đủ lớn (lý tưởng là bằng số partitions) để xử lý kịp tốc độ producer.</p></li><li><p>Tài nguyên: Brokers có đủ CPU, RAM (đặc biệt cho page cache), và Disk I/O.</p></li></ul><p><strong>Bottlenecks</strong>: Disk I/O trên brokers, network bandwidth, CPU của consumer nếu xử lý quá phức tạp, ZooKeeper (trong các phiên bản cũ hơn, KRaft thay thế ZooKeeper trong các phiên bản mới).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rabbitmq">RabbitMQ<a href="#rabbitmq" class="hash-link" aria-label="Direct link to RabbitMQ" title="Direct link to RabbitMQ">​</a></h4><p><strong>Khả năng mở rộng</strong>:</p><ul><li><p>Competing Consumers: Thêm nhiều instances của cùng một consumer đọc từ một queue duy nhất. RabbitMQ sẽ phân phối tin nhắn (round-robin) cho các consumer sẵn sàng.</p></li><li><p>Clustering: Kết nối nhiều node RabbitMQ thành một cụm logic. Tuy nhiên, một queue cụ thể vẫn thường chỉ tồn tại trên một node (trừ khi dùng Quorum Queues hoặc Mirrored Queues - có ảnh hưởng hiệu năng).</p></li><li><p>Shovel/Federation: Plugin cho phép chuyển tin nhắn giữa các broker/cluster khác nhau, hữu ích cho các kịch bản phân tán địa lý hoặc cần tách biệt tải.</p></li></ul><p><strong>Ảnh hưởng</strong>: Với hàng ngàn request/giây:</p><ul><li><p>Single Queue Bottleneck: Nếu tất cả tin nhắn đổ vào một queue duy nhất và xử lý tốn thời gian, queue đó có thể trở thành điểm nghẽn ngay cả khi có nhiều consumer. Tốc độ bị giới hạn bởi tốc độ xử lý của consumer nhanh nhất và khả năng phân phối của queue.</p></li><li><p>outing Complexity: Các mô hình routing phức tạp có thể tiêu tốn CPU trên broker.</p></li><li><p>Acknowledgements: Việc chờ ack có thể làm chậm quá trình nếu consumer xử lý lâu.</p></li></ul><p><strong>Bottlenecks</strong>: CPU/RAM trên node chứa queue bị quá tải, network giữa các node trong cluster, tốc độ xử lý và ack của consumer.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hình-dung-cấu-trúc-và-khả-năng-mở-rộng-visualization">Hình Dung Cấu Trúc và Khả Năng Mở Rộng (Visualization)<a href="#hình-dung-cấu-trúc-và-khả-năng-mở-rộng-visualization" class="hash-link" aria-label="Direct link to Hình Dung Cấu Trúc và Khả Năng Mở Rộng (Visualization)" title="Direct link to Hình Dung Cấu Trúc và Khả Năng Mở Rộng (Visualization)">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-visualization">Kafka Visualization<a href="#kafka-visualization" class="hash-link" aria-label="Direct link to Kafka Visualization" title="Direct link to Kafka Visualization">​</a></h3><p>Kafka phân tán dữ liệu của một topic qua nhiều partition, và các partition này được lưu trữ trên các broker khác nhau. Consumer group cho phép xử lý song song.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+      +----------+      +----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Producer | ----&gt;| Broker 1 |&lt;----&gt;| Broker 2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+      |----------|      |----------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  | Topic A: |      | Topic A: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  |   P0     |      |   P1     |  &lt;-- Partitions (P)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  |   P2     |      |   P3     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  +----------+      +----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ^                 ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       |                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------+----------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Consumer Group G1                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | Consumer 1 |&lt;------ | P0, P2     |        |  &lt;-- Each consumer handles specific partitions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | Consumer 2 |&lt;------ | P1, P3     |        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="khi-scale-out-thêm-broker-và-consumer">Khi Scale Out (Thêm Broker và Consumer):<a href="#khi-scale-out-thêm-broker-và-consumer" class="hash-link" aria-label="Direct link to Khi Scale Out (Thêm Broker và Consumer):" title="Direct link to Khi Scale Out (Thêm Broker và Consumer):">​</a></h4><p>Chúng ta thêm Broker 3, tăng số partition cho Topic A (ví dụ: P4, P5), và thêm Consumer 3 vào Group G1. Kafka sẽ tự động rebalance để phân phối lại các partition cho các consumer.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+      +----------+      +----------+      +----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Producer | ----&gt;| Broker 1 |&lt;----&gt;| Broker 2 |&lt;----&gt;| Broker 3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+      |----------|      |----------|      |----------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  | Topic A: |      | Topic A: |      | Topic A: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  |   P0     |      |   P1     |      |   P4     | &lt;-- New Partitions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  |   P2     |      |   P3     |      |   P5     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  +----------+      +----------+      +----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ^                 ^                 ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       |                 |                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------+-----------------+-----------------+--+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Consumer Group G1 (Rebalanced)                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | Consumer 1 |&lt;------ | P0, P2     |                    | &lt;-- Consumers now handle potentially different partitions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | Consumer 2 |&lt;------ | P1, P4     |                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | Consumer 3 |&lt;------ | P3, P5     |                    | &lt;-- New Consumer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| +------------+        +------------+                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rabbitmq-visualization">RabbitMQ Visualization<a href="#rabbitmq-visualization" class="hash-link" aria-label="Direct link to RabbitMQ Visualization" title="Direct link to RabbitMQ Visualization">​</a></h3><p>RabbitMQ tập trung vào định tuyến linh hoạt qua exchanges và xử lý song song trên cùng một queue bằng competing consumers.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cấu-trúc-cơ-bản-direct-exchange">Cấu trúc cơ bản (Direct Exchange):<a href="#cấu-trúc-cơ-bản-direct-exchange" class="hash-link" aria-label="Direct link to Cấu trúc cơ bản (Direct Exchange):" title="Direct link to Cấu trúc cơ bản (Direct Exchange):">​</a></h4><p>Producer gửi tin nhắn đến exchange, exchange định tuyến đến queue dựa trên routing key.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+       +---------------------+       +-----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Producer | ----&gt; | Exchange (Direct)   | ----&gt; | Queue A         | &lt;-- Binding Key = &quot;keyA&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+       | Routing Key: &quot;keyA&quot; |       | (Msg for keyA)  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   +---------------------+       +-----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                       V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                 +------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                 | Consumer 1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                 +------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cấu-trúc-cơ-bản-fanout-exchange">Cấu trúc cơ bản (Fanout Exchange):<a href="#cấu-trúc-cơ-bản-fanout-exchange" class="hash-link" aria-label="Direct link to Cấu trúc cơ bản (Fanout Exchange):" title="Direct link to Cấu trúc cơ bản (Fanout Exchange):">​</a></h4><p>Cách phổ biến nhất để scale RabbitMQ là thêm nhiều consumer instance cùng đọc từ một queue. RabbitMQ sẽ phân phối tin nhắn cho các consumer rảnh rỗi (round-robin hoặc dựa trên prefetch).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+       +---------------------+       +-----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Producer | ----&gt; | Exchange (Direct)   | ----&gt; | Queue D         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+       | Routing Key: &quot;task&quot; |       | (Task Queue)    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   +---------------------+       +-----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     -------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     |        |        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     V        V        V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               +------------++------------++------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               | Consumer 1 || Consumer 2 || Consumer 3 | &lt;-- Multiple consumers processing tasks from Queue D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               +------------++------------++------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kỹ-thuật-tối-ưu-hóa">Kỹ Thuật Tối Ưu Hóa<a href="#kỹ-thuật-tối-ưu-hóa" class="hash-link" aria-label="Direct link to Kỹ Thuật Tối Ưu Hóa" title="Direct link to Kỹ Thuật Tối Ưu Hóa">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-1">Kafka<a href="#kafka-1" class="hash-link" aria-label="Direct link to Kafka" title="Direct link to Kafka">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="producers">Producers:<a href="#producers" class="hash-link" aria-label="Direct link to Producers:" title="Direct link to Producers:">​</a></h4><ul><li><p>batch.size &amp; linger.ms: Tăng kích thước batch và thời gian chờ để gửi nhiều tin nhắn hơn trong một request, giảm overhead mạng.</p></li><li><p>compression.type: Sử dụng nén (snappy, gzip, lz4, zstd) để giảm kích thước tin nhắn, tiết kiệm băng thông và dung lượng lưu trữ.</p></li><li><p>acks: Cấu hình mức độ đảm bảo (acks=0, acks=1, acks=all). acks=1 là cân bằng tốt giữa độ bền và hiệu năng.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="brokers">Brokers:<a href="#brokers" class="hash-link" aria-label="Direct link to Brokers:" title="Direct link to Brokers:">​</a></h4><ul><li><p>Tuning JVM heap size.</p></li><li><p>Đảm bảo đủ RAM cho page cache của OS (Kafka tận dụng mạnh mẽ page cache).</p></li><li><p>Sử dụng ổ cứng nhanh (SSD).</p></li><li><p>Tăng số network/IO threads nếu cần.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="consumers">Consumers:<a href="#consumers" class="hash-link" aria-label="Direct link to Consumers:" title="Direct link to Consumers:">​</a></h4><ul><li><p>fetch.min.bytes &amp; fetch.max.wait.ms: Điều chỉnh lượng dữ liệu tối thiểu consumer muốn nhận hoặc thời gian chờ tối đa, tương tự batching ở producer.</p></li><li><p>Xử lý song song trong consumer instance (nếu logic cho phép).</p></li><li><p>Quản lý offset cẩn thận (commit định kỳ, tránh commit quá thường xuyên).</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rabbitmq-1">RabbitMQ<a href="#rabbitmq-1" class="hash-link" aria-label="Direct link to RabbitMQ" title="Direct link to RabbitMQ">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="consumers-1">Consumers:<a href="#consumers-1" class="hash-link" aria-label="Direct link to Consumers:" title="Direct link to Consumers:">​</a></h4><ul><li><p>Prefetch Count (QoS): Xác định số lượng tin nhắn tối đa mà broker có thể gửi cho consumer mà chưa nhận được ack. Giá trị quá cao có thể làm consumer bị quá tải, giá trị quá thấp làm giảm thông lượng. Cần tuning cẩn thận.</p></li><li><p>Sử dụng manual acknowledgements một cách hiệu quả.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="queues">Queues:<a href="#queues" class="hash-link" aria-label="Direct link to Queues:" title="Direct link to Queues:">​</a></h4><ul><li><p>Persistent vs. Transient Messages/Queues: Tin nhắn/queue bền vững (persistent) được ghi xuống đĩa, đảm bảo không mất khi broker khởi động lại nhưng chậm hơn. Transient nhanh hơn nhưng dữ liệu mất khi restart. Chọn tùy theo yêu cầu độ bền.</p></li><li><p>Lazy Queues: Giữ tin nhắn trên đĩa nhiều hơn, giảm sử dụng RAM, hữu ích cho các queue rất dài nhưng có thể tăng độ trễ.</p></li><li><p>Quorum Queues: Cung cấp độ bền và tính sẵn sàng cao hơn so với mirrored queues cổ điển, là lựa chọn khuyến nghị cho các phiên bản RabbitMQ mới.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="producers-1">Producers:<a href="#producers-1" class="hash-link" aria-label="Direct link to Producers:" title="Direct link to Producers:">​</a></h4><ul><li><p>Sử dụng persistent messages nếu cần độ bền.</p></li><li><p>Connection/Channel Pooling: Tái sử dụng kết nối và channel để giảm overhead thiết lập.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="broker">Broker:<a href="#broker" class="hash-link" aria-label="Direct link to Broker:" title="Direct link to Broker:">​</a></h4><ul><li><p>Tuning Erlang VM (số lượng scheduler threads).</p></li><li><p>Giám sát memory/disk alarms.</p></li><li><p>Sử dụng HiPE (không còn được khuyến nghị nhiều như trước).</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases-điển-hình">Use Cases Điển Hình<a href="#use-cases-điển-hình" class="hash-link" aria-label="Direct link to Use Cases Điển Hình" title="Direct link to Use Cases Điển Hình">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="chọn-kafka-khi">Chọn Kafka khi:<a href="#chọn-kafka-khi" class="hash-link" aria-label="Direct link to Chọn Kafka khi:" title="Direct link to Chọn Kafka khi:">​</a></h4><ul><li><p>Cần thông lượng cực cao (log aggregation, IoT data streams, metrics).</p></li><li><p>Cần lưu trữ dữ liệu lâu dài và có khả năng đọc lại (event sourcing, stream processing).</p></li><li><p>Thứ tự tin nhắn trong một ngữ cảnh (partition) là quan trọng.</p></li><li><p>Xây dựng các pipeline dữ liệu real-time.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="chọn-rabbitmq-khi">Chọn RabbitMQ khi:<a href="#chọn-rabbitmq-khi" class="hash-link" aria-label="Direct link to Chọn RabbitMQ khi:" title="Direct link to Chọn RabbitMQ khi:">​</a></h4><ul><li><p>Cần các mô hình định tuyến phức tạp.</p></li><li><p>Cần tích hợp với các hệ thống cũ hoặc nhiều giao thức (AMQP, MQTT, STOMP).</p></li><li><p>Ưu tiên độ trễ thấp cho các tác vụ nhỏ.</p></li><li><p>Cần triển khai mô hình task queue (worker queues).</p></li><li><p>Cần mô hình request/response đơn giản.</p></li><li><p>Đảm bảo gửi tin nhắn ở mức độ per-message là quan trọng.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mô-hình-requestresponse-trong-rabbitmq">Mô Hình Request/Response trong RabbitMQ<a href="#mô-hình-requestresponse-trong-rabbitmq" class="hash-link" aria-label="Direct link to Mô Hình Request/Response trong RabbitMQ" title="Direct link to Mô Hình Request/Response trong RabbitMQ">​</a></h2><p>RabbitMQ hỗ trợ tốt mô hình RPC (Remote Procedure Call) hay Request/Response. Cơ chế hoạt động như sau:</p><ol><li>Client (Requester):</li></ol><ul><li><p>Tạo một exclusive callback queue (queue tạm thời, chỉ client này đọc được và tự động xóa khi client disconnect).</p></li><li><p>Gửi tin nhắn request đến một RPC queue cố định mà Server đang lắng nghe.</p></li><li><p>Trong tin nhắn request, đặt hai thuộc tính quan trọng trong properties:</p><ul><li><p>reply_to: Tên của callback queue vừa tạo.</p></li><li><p>correlation_id: Một giá trị duy nhất để định danh request này (ví dụ: UUID).</p></li></ul></li><li><p>Bắt đầu lắng nghe trên callback queue của mình.</p></li></ul><ol start="2"><li>Server (Replier):</li></ol><ul><li><p>Lắng nghe tin nhắn trên RPC queue cố định.</p></li><li><p>Khi nhận được tin nhắn request:</p><ul><li><p>Xử lý request.</p></li><li><p>Lấy reply_to và correlation_id từ properties của tin nhắn request.</p></li><li><p>Gửi tin nhắn response chứa kết quả xử lý đến exchange mặc định (&quot;&quot;) với routing_key chính là giá trị của reply_to (tên callback queue của client).</p></li><li><p>Đặt correlation_id trong tin nhắn response giống hệt correlation_id của tin nhắn request.</p></li></ul></li></ul><ol start="3"><li>Client (Requester):</li></ol><ul><li><p>Nhận được tin nhắn response trên callback queue.</p></li><li><p>Kiểm tra correlation_id của response để khớp với request tương ứng đã gửi.</p></li><li><p>Xử lý kết quả response.</p></li></ul><p>Cơ chế này cho phép client gửi nhiều request mà không cần đợi response tuần tự, vì correlation_id giúp khớp đúng response với request.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/programming/golang"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Golang</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/programming/redis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Redis</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#kiến-trúc-cốt-lõi" class="table-of-contents__link toc-highlight">Kiến Trúc Cốt Lõi</a></li><li><a href="#so-sánh-chi-tiết" class="table-of-contents__link toc-highlight">So Sánh Chi Tiết</a></li><li><a href="#xử-lý-tải-cao-hàng-ngàn-requestgiây" class="table-of-contents__link toc-highlight">Xử Lý Tải Cao (Hàng Ngàn Request/giây)</a></li><li><a href="#hình-dung-cấu-trúc-và-khả-năng-mở-rộng-visualization" class="table-of-contents__link toc-highlight">Hình Dung Cấu Trúc và Khả Năng Mở Rộng (Visualization)</a><ul><li><a href="#kafka-visualization" class="table-of-contents__link toc-highlight">Kafka Visualization</a></li><li><a href="#rabbitmq-visualization" class="table-of-contents__link toc-highlight">RabbitMQ Visualization</a></li></ul></li><li><a href="#kỹ-thuật-tối-ưu-hóa" class="table-of-contents__link toc-highlight">Kỹ Thuật Tối Ưu Hóa</a><ul><li><a href="#kafka-1" class="table-of-contents__link toc-highlight">Kafka</a></li><li><a href="#rabbitmq-1" class="table-of-contents__link toc-highlight">RabbitMQ</a></li></ul></li><li><a href="#use-cases-điển-hình" class="table-of-contents__link toc-highlight">Use Cases Điển Hình</a></li><li><a href="#mô-hình-requestresponse-trong-rabbitmq" class="table-of-contents__link toc-highlight">Mô Hình Request/Response trong RabbitMQ</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/icon.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="40" height="40"><img src="/img/icon.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="40" height="40"></a></div><div class="footer__copyright">Copyright © 2025 Quan Kori</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9e9ccc88.js"></script>
<script src="/assets/js/main.8db436b3.js"></script>
</body>
</html>