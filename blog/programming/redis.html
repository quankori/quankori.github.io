<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blog/programming/redis">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Redis | Quan Nguyen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://quankori.github.io/blog/programming/redis"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Redis | Quan Nguyen"><meta data-rh="true" name="description" content="Redis (Remote Dictionary Server) không chỉ là một key-value store đơn giản. Nó là một kho lưu trữ cấu trúc dữ liệu trong bộ nhớ (in-memory data structure store) cực kỳ nhanh chóng và linh hoạt, được sử dụng rộng rãi cho caching, quản lý session, message broker, real-time analytics."><meta data-rh="true" property="og:description" content="Redis (Remote Dictionary Server) không chỉ là một key-value store đơn giản. Nó là một kho lưu trữ cấu trúc dữ liệu trong bộ nhớ (in-memory data structure store) cực kỳ nhanh chóng và linh hoạt, được sử dụng rộng rãi cho caching, quản lý session, message broker, real-time analytics."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://quankori.github.io/blog/programming/redis"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/programming/redis" hreflang="en"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/programming/redis" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://a-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Quan Nguyen" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d2c8af8d.css">
<link rel="preload" href="/assets/js/runtime~main.9e9ccc88.js" as="script">
<link rel="preload" href="/assets/js/main.8db436b3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kori Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">My Note</a></div><div class="navbar__items navbar__items--right"><div class="navbar-search searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://www.linkedin.com/in/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-icon" title="My Github" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">About Me</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/system-design/checklist">System Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/programming/nodejs">Programming Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/nodejs">Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/golang">Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/message-queue">Message Queue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/programming/redis">Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/computer-science">Computer Science</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/programming-design-pattern">Programming Design Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/programming/design-principle">Design Principle</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/english/cheatsheet">English</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Programming Language</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Redis</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Redis</h1></header><p>Redis (Remote Dictionary Server) không chỉ là một key-value store đơn giản. Nó là một kho lưu trữ cấu trúc dữ liệu trong bộ nhớ (in-memory data structure store) cực kỳ nhanh chóng và linh hoạt, được sử dụng rộng rãi cho caching, quản lý session, message broker, real-time analytics.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tối-ưu-hiệu-năng-redis-redis-performance-optimization">Tối ưu Hiệu năng Redis (Redis Performance Optimization)<a href="#tối-ưu-hiệu-năng-redis-redis-performance-optimization" class="hash-link" aria-label="Direct link to Tối ưu Hiệu năng Redis (Redis Performance Optimization)" title="Direct link to Tối ưu Hiệu năng Redis (Redis Performance Optimization)">​</a></h2><p>Để Redis hoạt động với tốc độ cao nhất và sử dụng tài nguyên hiệu quả, hãy xem xét các điểm sau:</p><ul><li><p>maxmemory: Đặt giới hạn bộ nhớ tối đa Redis có thể sử dụng trong file cấu hình (redis.conf). Khi đạt đến giới hạn này, Redis sẽ áp dụng chính sách loại bỏ (eviction policy).</p><ul><li><p>maxmemory-policy: Chọn chính sách loại bỏ phù hợp với use case của bạn. Các chính sách phổ biến:</p><ul><li><p>noeviction: Không xóa key nào khi đầy bộ nhớ, trả lỗi cho các lệnh ghi mới (không nên dùng cho cache).</p></li><li><p>allkeys-lru: Xóa các key ít được sử dụng gần đây nhất (Least Recently Used) trong toàn bộ keyspace. Thường là lựa chọn tốt cho cache.</p></li><li><p>volatile-lru: Chỉ xóa các key ít được sử dụng gần đây nhất trong số các key có đặt TTL (Time-To-Live).</p></li><li><p>allkeys-lfu: Xóa các key ít được sử dụng thường xuyên nhất (Least Frequently Used).</p></li><li><p>volatile-lfu: Chỉ xóa các key ít được sử dụng thường xuyên nhất trong số các key có đặt TTL.</p></li><li><p>allkeys-random: Xóa key ngẫu nhiên.</p></li><li><p>volatile-random: Xóa key ngẫu nhiên trong số các key có TTL.</p></li><li><p>volatile-ttl: Xóa các key có TTL sắp hết hạn nhất.</p></li></ul></li><li><p>Theo dõi việc sử dụng bộ nhớ (INFO memory) để điều chỉnh maxmemory hợp lý.</p></li></ul></li><li><p>Chọn Đúng Cấu trúc Dữ liệu:</p><ul><li><p>Redis hỗ trợ nhiều cấu trúc dữ liệu (Strings, Hashes, Lists, Sets, Sorted Sets, Streams, HyperLogLogs, Bitmaps,...).</p></li><li><p>Sử dụng cấu trúc phù hợp giúp tiết kiệm bộ nhớ và tăng tốc độ truy cập.</p></li></ul></li><li><p>Pipelining:</p><ul><li><p>Giảm độ trễ mạng bằng cách gửi nhiều lệnh đến Redis server trong một lượt đi (round trip) thay vì gửi từng lệnh và chờ phản hồi. Client library sẽ đợi tất cả phản hồi trả về cùng lúc.</p></li><li><p>Rất hiệu quả khi bạn cần thực hiện nhiều lệnh liên tiếp.</p></li></ul></li><li><p>Persistence (Lưu trữ Bền vững):</p><ul><li><p>Redis cung cấp hai cơ chế chính:</p><ul><li><p>RDB (Snapshotting): Lưu trạng thái database vào một file .rdb theo chu kỳ. Nhanh hơn khi khởi động lại, file nhỏ gọn hơn, nhưng có thể mất dữ liệu giữa các lần snapshot.</p></li><li><p>AOF (Append Only File): Ghi lại mọi lệnh ghi vào một file log. Bền hơn RDB (có thể cấu hình tần suất fsync), nhưng file lớn hơn và khởi động lại chậm hơn.</p></li></ul></li><li><p>Trade-off: Chọn cơ chế phù hợp dựa trên yêu cầu về độ bền dữ liệu và hiệu năng.</p></li><li><p>Tối ưu cho Cache: Nếu chỉ dùng Redis làm cache (dữ liệu có thể tái tạo từ nguồn khác), bạn có thể tắt hoàn toàn persistence để đạt hiệu năng ghi cao nhất.</p></li></ul></li><li><p>Connection Pooling (Phía Client): Luôn sử dụng connection pool ở tầng ứng dụng để tái sử dụng các kết nối TCP đến Redis server, tránh chi phí thiết lập kết nối mới cho mỗi yêu cầu. Hầu hết các Redis client library đều hỗ trợ connection pooling.</p></li><li><p>Mạng (Networking):</p><ul><li><p>Đặt Redis server và client ứng dụng càng gần nhau càng tốt (cùng datacenter, cùng availability zone) để giảm độ trễ mạng.</p></li><li><p>Nếu client và server trên cùng một máy, cân nhắc sử dụng Unix domain sockets thay vì TCP/IP để tăng tốc độ.</p></li></ul></li><li><p>Giám sát (Monitoring):</p><ul><li><p>Sử dụng lệnh INFO để xem trạng thái chi tiết của Redis server (memory, clients, stats, persistence,...).</p></li><li><p>Sử dụng các công cụ như redis-cli --stat, htop, hoặc các giải pháp monitoring chuyên dụng (Prometheus Redis Exporter, Datadog, New Relic) để theo dõi hiệu năng và phát hiện vấn đề sớm.</p></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="các-caching-pattern-phổ-biến-với-redis">Các Caching Pattern Phổ biến với Redis<a href="#các-caching-pattern-phổ-biến-với-redis" class="hash-link" aria-label="Direct link to Các Caching Pattern Phổ biến với Redis" title="Direct link to Các Caching Pattern Phổ biến với Redis">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cache-aside-lazy-loading">Cache-Aside (Lazy Loading):<a href="#cache-aside-lazy-loading" class="hash-link" aria-label="Direct link to Cache-Aside (Lazy Loading):" title="Direct link to Cache-Aside (Lazy Loading):">​</a></h4><ul><li><p>Luồng hoạt động:</p><ul><li><p>Ứng dụng kiểm tra xem dữ liệu có trong Redis cache không (GET key).</p></li><li><p>Cache Hit: Nếu có, trả về dữ liệu từ cache.</p></li><li><p>Cache Miss: Nếu không có:</p><ul><li>a. Ứng dụng truy vấn dữ liệu từ database chính (nguồn sự thật - source of truth).</li><li>b. Ứng dụng lưu dữ liệu vừa lấy được vào Redis cache (SET key value EX ttl).</li><li>c. Ứng dụng trả về dữ liệu cho client.</li></ul></li></ul></li><li><p>Ưu điểm: Chỉ cache những dữ liệu thực sự được yêu cầu. Dễ triển khai. Redis không cần biết về database.</p></li><li><p>Nhược điểm: Cache Miss Penalty: Lần đầu tiên truy cập dữ liệu sẽ chậm hơn vì phải đọc từ DB và ghi vào cache.</p></li><li><p>Stale Data (Dữ liệu cũ): Dữ liệu trong cache có thể trở nên cũ nếu dữ liệu trong DB thay đổi trước khi cache hết hạn (TTL). Cần có chiến lược làm mới cache (ví dụ: xóa key trong cache khi cập nhật DB, hoặc chấp nhận dữ liệu cũ trong khoảng TTL).</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="read-through">Read-Through:<a href="#read-through" class="hash-link" aria-label="Direct link to Read-Through:" title="Direct link to Read-Through:">​</a></h4><ul><li><p>Luồng hoạt động: Ứng dụng luôn gọi đến cache để lấy dữ liệu. Cache provider (có thể là một thư viện hoặc proxy) sẽ tự kiểm tra cache. Nếu miss, cache provider sẽ tự động lấy dữ liệu từ DB, lưu vào cache và trả về cho ứng dụng.</p></li><li><p>Với Redis: Pattern này ít phổ biến hơn vì Redis tự nó không trực tiếp tương tác với DB. Thường cần một lớp thư viện/framework hỗ trợ để triển khai logic này.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="write-through">Write-Through:<a href="#write-through" class="hash-link" aria-label="Direct link to Write-Through:" title="Direct link to Write-Through:">​</a></h4><ul><li><p>Luồng hoạt động:</p><ul><li><p>Ứng dụng thực hiện thao tác ghi.</p></li><li><p>Ghi dữ liệu vào Redis cache (SET key value).</p></li><li><p>Đồng thời hoặc ngay sau đó, ghi dữ liệu vào database chính. Cả hai thao tác phải thành công (hoặc có cơ chế xử lý lỗi/retry).</p></li></ul></li><li><p>Ưu điểm: Dữ liệu trong cache và DB luôn (hoặc gần như luôn) nhất quán. Giảm khả năng đọc phải dữ liệu cũ sau khi ghi.</p></li><li><p>Nhược điểm: Tăng độ trễ cho thao tác ghi vì phải ghi vào cả hai nơi. Nếu Redis không sẵn sàng, thao tác ghi có thể thất bại (trừ khi có xử lý phù hợp).</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="write-behind-write-back">Write-Behind (Write-Back):<a href="#write-behind-write-back" class="hash-link" aria-label="Direct link to Write-Behind (Write-Back):" title="Direct link to Write-Behind (Write-Back):">​</a></h4><ul><li><p>Luồng hoạt động:</p><ul><li><p>Ứng dụng thực hiện thao tác ghi.</p></li><li><p>Ghi dữ liệu vào Redis cache (SET key value). Thao tác này thường rất nhanh.</p></li><li><p>Ứng dụng trả về thành công cho client ngay lập tức.</p></li><li><p>Sau một khoảng thời gian trễ hoặc theo một batch, dữ liệu từ cache sẽ được ghi vào database chính một cách bất đồng bộ.</p></li></ul></li><li><p>Ưu điểm: Thao tác ghi cực kỳ nhanh vì chỉ cần ghi vào Redis. Giảm tải cho database chính.</p></li><li><p>Nhược điểm:</p><ul><li><p>Rủi ro mất dữ liệu: Nếu Redis gặp sự cố trước khi dữ liệu kịp ghi vào DB, dữ liệu đó sẽ bị mất.</p></li><li><p>Phức tạp: Cần triển khai cơ chế đáng tin cậy để ghi dữ liệu từ cache vào DB.</p></li><li><p>Dữ liệu trong DB có thể không nhất quán với cache trong một khoảng thời gian.</p></li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cache-eviction-và-ttl">Cache Eviction và TTL:<a href="#cache-eviction-và-ttl" class="hash-link" aria-label="Direct link to Cache Eviction và TTL:" title="Direct link to Cache Eviction và TTL:">​</a></h4><ul><li><p>Luôn đặt TTL (Time-To-Live) hợp lý cho các cache key bằng lệnh EXPIRE hoặc các tùy chọn EX/PX trong lệnh SET. TTL giúp tự động xóa dữ liệu cũ, giải phóng bộ nhớ và giảm nguy cơ stale data.</p></li><li><p>Chọn maxmemory-policy phù hợp (thường là allkeys-lru hoặc volatile-lru cho cache) để Redis biết cách xử lý khi bộ nhớ đầy.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="những-điều-cần-quan-tâm-khi-setget-trong-redis">Những điều cần quan tâm khi SET/GET trong Redis<a href="#những-điều-cần-quan-tâm-khi-setget-trong-redis" class="hash-link" aria-label="Direct link to Những điều cần quan tâm khi SET/GET trong Redis" title="Direct link to Những điều cần quan tâm khi SET/GET trong Redis">​</a></h2><p>Khi làm việc với các lệnh cơ bản như SET và GET, hãy lưu ý:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="quy-ước-đặt-tên-key-key-naming-conventions">Quy ước Đặt tên Key (Key Naming Conventions):<a href="#quy-ước-đặt-tên-key-key-naming-conventions" class="hash-link" aria-label="Direct link to Quy ước Đặt tên Key (Key Naming Conventions):" title="Direct link to Quy ước Đặt tên Key (Key Naming Conventions):">​</a></h4><p>Sử dụng tên key rõ ràng, có cấu trúc và nhất quán.</p><p>Dùng dấu hai chấm (:) để phân cấp, ví dụ: <code>object-type:id:field</code> -&gt; <code>user:123:profile</code>, <code>product:abc:stock</code>.</p><p>Giữ tên key hợp lý, không quá dài (tốn bộ nhớ) nhưng đủ mô tả.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="serialization-tuần-tự-hóa">Serialization (Tuần tự hóa):<a href="#serialization-tuần-tự-hóa" class="hash-link" aria-label="Direct link to Serialization (Tuần tự hóa):" title="Direct link to Serialization (Tuần tự hóa):">​</a></h4><p>Redis lưu trữ dữ liệu dưới dạng byte sequences. Khi lưu các cấu trúc dữ liệu phức tạp (object, array), bạn cần tuần tự hóa chúng thành một định dạng như JSON, MessagePack, BSON,... trước khi SET, và giải tuần tự hóa sau khi GET.</p><p>JSON là phổ biến nhất, dễ đọc, nhưng có thể tốn dung lượng hơn MessagePack. Chọn định dạng phù hợp với nhu cầu về hiệu năng và dung lượng.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="atomicity-tính-nguyên-tử">Atomicity (Tính Nguyên tử):<a href="#atomicity-tính-nguyên-tử" class="hash-link" aria-label="Direct link to Atomicity (Tính Nguyên tử):" title="Direct link to Atomicity (Tính Nguyên tử):">​</a></h4><p>Mỗi lệnh Redis đơn lẻ (như SET, GET, INCR) là nguyên tử.</p><p>Nếu cần thực hiện nhiều thao tác một cách nguyên tử (ví dụ: đọc một giá trị và ghi lại giá trị mới dựa trên nó), hãy sử dụng:</p><ul><li><p>Transactions (MULTI/EXEC): Nhóm nhiều lệnh lại, chúng sẽ được thực thi tuần tự mà không bị lệnh từ client khác xen vào. Tuy nhiên, nó không có cơ chế rollback nếu một lệnh giữa chừng thất bại logic (ví dụ: kiểu dữ liệu sai).</p></li><li><p>Lua Scripts (EVAL, EVALSHA): Cách mạnh mẽ hơn để đảm bảo tính nguyên tử cho các logic phức tạp. Script Lua chạy trên server Redis, giảm thiểu network round trips và đảm bảo không bị gián đoạn.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xử-lý-lỗi-error-handling">Xử lý Lỗi (Error Handling):<a href="#xử-lý-lỗi-error-handling" class="hash-link" aria-label="Direct link to Xử lý Lỗi (Error Handling):" title="Direct link to Xử lý Lỗi (Error Handling):">​</a></h4><p>Luôn kiểm tra lỗi kết nối, timeout khi tương tác với Redis.</p><p>Lệnh GET trả về nil (hoặc null tùy client library) nếu key không tồn tại. Cần xử lý trường hợp này (thường là cache miss).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kích-thước-dữ-liệu-data-size">Kích thước Dữ liệu (Data Size):<a href="#kích-thước-dữ-liệu-data-size" class="hash-link" aria-label="Direct link to Kích thước Dữ liệu (Data Size):" title="Direct link to Kích thước Dữ liệu (Data Size):">​</a></h4><p>Tránh lưu trữ các giá trị (value) quá lớn (hàng MB) trong một key duy nhất. Điều này có thể làm chậm Redis, tăng độ trễ mạng và tốn bộ nhớ.</p><p>Nếu cần lưu dữ liệu lớn, cân nhắc chia nhỏ hoặc lưu trữ ở nơi khác (như S3) và chỉ lưu key/metadata trong Redis.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="các-kiểu-setget-và-use-case-hợp-lý">Các Kiểu SET/GET và Use Case Hợp lý<a href="#các-kiểu-setget-và-use-case-hợp-lý" class="hash-link" aria-label="Direct link to Các Kiểu SET/GET và Use Case Hợp lý" title="Direct link to Các Kiểu SET/GET và Use Case Hợp lý">​</a></h2><p>Redis cung cấp nhiều biến thể của lệnh SET và GET cho các tình huống khác nhau:</p><ul><li><p>SET key value: Ghi đè giá trị của key nếu nó đã tồn tại. Dùng khi bạn muốn cập nhật giá trị một cách vô điều kiện.</p></li><li><p>GET key: Lấy giá trị của key. Trả về nil nếu key không tồn tại. Dùng để đọc dữ liệu.</p></li><li><p>SETNX key value (SET if Not eXists): Chỉ đặt giá trị nếu key chưa tồn tại. Trả về 1 nếu thành công, 0 nếu key đã tồn tại.</p><ul><li>Use Case: Triển khai distributed lock cơ bản (cần kết hợp với TTL), đảm bảo một tác vụ chỉ được thực hiện bởi một tiến trình tại một thời điểm.</li></ul></li><li><p>SETEX key seconds value / PSETEX key milliseconds value: Đặt giá trị và tự động gán TTL (tính bằng giây hoặc mili giây).</p><ul><li>Use Case: Caching là trường hợp sử dụng chính. Đảm bảo cache tự động hết hạn.</li></ul></li><li><p>SET key value <!-- -->[EX seconds | PX milliseconds][NX | XX]<!-- -->: Lệnh SET hiện đại, kết hợp nhiều chức năng:</p><ul><li><p>EX seconds / PX milliseconds: Tương tự SETEX/PSETEX.</p></li><li><p>NX: Tương tự SETNX.</p></li><li><p>XX: Chỉ đặt giá trị nếu key đã tồn tại. Dùng khi bạn chỉ muốn cập nhật key hiện có, không tạo key mới.</p></li><li><p>Khuyến nghị: Nên sử dụng lệnh SET với các tùy chọn này thay vì các lệnh cũ như SETNX, SETEX vì nó nguyên tử hơn (ví dụ: SET key value NX EX ttl đảm bảo cả việc kiểm tra tồn tại và đặt TTL xảy ra trong một bước).</p></li></ul></li><li><p>MSET key value <!-- -->[key value ...]<!-- -->: Đặt giá trị cho nhiều key cùng lúc một cách nguyên tử.</p><ul><li>Use Case: Cập nhật nhiều thông tin liên quan cùng lúc, hiệu quả hơn nhiều lệnh SET riêng lẻ.</li></ul></li><li><p>MGET key <!-- -->[key ...]<!-- -->: Lấy giá trị của nhiều key cùng lúc.</p><ul><li>Use Case: Lấy nhiều mục cache hoặc thông tin liên quan trong một lượt truy vấn, giảm network round trips.</li></ul></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/programming/message-queue"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Message Queue</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/programming/computer-science"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Computer Science</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tối-ưu-hiệu-năng-redis-redis-performance-optimization" class="table-of-contents__link toc-highlight">Tối ưu Hiệu năng Redis (Redis Performance Optimization)</a></li><li><a href="#các-caching-pattern-phổ-biến-với-redis" class="table-of-contents__link toc-highlight">Các Caching Pattern Phổ biến với Redis</a></li><li><a href="#những-điều-cần-quan-tâm-khi-setget-trong-redis" class="table-of-contents__link toc-highlight">Những điều cần quan tâm khi SET/GET trong Redis</a></li><li><a href="#các-kiểu-setget-và-use-case-hợp-lý" class="table-of-contents__link toc-highlight">Các Kiểu SET/GET và Use Case Hợp lý</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/icon.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="40" height="40"><img src="/img/icon.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="40" height="40"></a></div><div class="footer__copyright">Copyright © 2025 Quan Kori</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9e9ccc88.js"></script>
<script src="/assets/js/main.8db436b3.js"></script>
</body>
</html>