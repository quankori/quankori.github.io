<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blog/system-design/microservices">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Microservices Architecture | Quan Nguyen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://quankori.github.io/blog/system-design/microservices"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Microservices Architecture | Quan Nguyen"><meta data-rh="true" name="description" content="Kiến trúc Microservices chia một ứng dụng lớn thành một tập hợp các dịch vụ nhỏ, độc lập, mỗi dịch vụ chạy trong tiến trình riêng và giao tiếp với nhau qua mạng. Mặc dù mang lại nhiều lợi ích về tính linh hoạt, khả năng mở rộng và tốc độ phát triển, kiến trúc này cũng đặt ra những thách thức mới, đặc biệt là trong việc giao tiếp giữa các dịch vụ và đảm bảo tính ổn định của toàn hệ thống."><meta data-rh="true" property="og:description" content="Kiến trúc Microservices chia một ứng dụng lớn thành một tập hợp các dịch vụ nhỏ, độc lập, mỗi dịch vụ chạy trong tiến trình riêng và giao tiếp với nhau qua mạng. Mặc dù mang lại nhiều lợi ích về tính linh hoạt, khả năng mở rộng và tốc độ phát triển, kiến trúc này cũng đặt ra những thách thức mới, đặc biệt là trong việc giao tiếp giữa các dịch vụ và đảm bảo tính ổn định của toàn hệ thống."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://quankori.github.io/blog/system-design/microservices"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/system-design/microservices" hreflang="en"><link data-rh="true" rel="alternate" href="https://quankori.github.io/blog/system-design/microservices" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://a-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Quan Nguyen" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.528574da.css">
<link rel="preload" href="/assets/js/runtime~main.77d03480.js" as="script">
<link rel="preload" href="/assets/js/main.447d2fc2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon.png" alt="Kori Blog" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kori Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">My Note</a></div><div class="navbar__items navbar__items--right"><div class="navbar-search searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://www.linkedin.com/in/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/quankori/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-icon" title="My Github" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">About Me</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/system-design/checklist">System Design</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/system-design/checklist">Checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/system-design/monolithic">Monolithic Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/system-design/domain-centric">Domain Centric Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/system-design/event-driven">Event Driven Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/system-design/microservices">Microservices Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/system-design/serverless">Serverless Architecture</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">System Design</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Microservices Architecture</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Microservices Architecture</h1></header><p>Kiến trúc Microservices chia một ứng dụng lớn thành một tập hợp các dịch vụ nhỏ, độc lập, mỗi dịch vụ chạy trong tiến trình riêng và giao tiếp với nhau qua mạng. Mặc dù mang lại nhiều lợi ích về tính linh hoạt, khả năng mở rộng và tốc độ phát triển, kiến trúc này cũng đặt ra những thách thức mới, đặc biệt là trong việc giao tiếp giữa các dịch vụ và đảm bảo tính ổn định của toàn hệ thống.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="communication-patterns">Communication Patterns<a href="#communication-patterns" class="hash-link" aria-label="Direct link to Communication Patterns" title="Direct link to Communication Patterns">​</a></h2><p>Việc lựa chọn cách các microservices giao tiếp với nhau ảnh hưởng lớn đến hiệu năng, độ phức tạp và khả năng phục hồi của hệ thống.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="synchronous-communication-giao-tiếp-đồng-bộ">Synchronous Communication (Giao tiếp đồng bộ):<a href="#synchronous-communication-giao-tiếp-đồng-bộ" class="hash-link" aria-label="Direct link to Synchronous Communication (Giao tiếp đồng bộ):" title="Direct link to Synchronous Communication (Giao tiếp đồng bộ):">​</a></h3><p>Một dịch vụ gửi yêu cầu (request) đến dịch vụ khác và đợi phản hồi (response). Hoạt động giống như một lời gọi hàm thông thường qua mạng. Ví dụ là REST APIs (qua HTTP/HTTPS), gRPC.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ưu-điểm">Ưu điểm:<a href="#ưu-điểm" class="hash-link" aria-label="Direct link to Ưu điểm:" title="Direct link to Ưu điểm:">​</a></h4><p>Đơn giản, dễ hiểu, luồng xử lý rõ ràng.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nhược-điểm">Nhược điểm:<a href="#nhược-điểm" class="hash-link" aria-label="Direct link to Nhược điểm:" title="Direct link to Nhược điểm:">​</a></h4><ul><li><p>Khớp nối thời gian (Temporal coupling): Dịch vụ gọi phải đợi dịch vụ được gọi xử lý xong. Nếu dịch vụ được gọi chậm hoặc lỗi, dịch vụ gọi cũng bị ảnh hưởng.</p></li><li><p>Giảm khả năng phục hồi: Lỗi ở một dịch vụ có thể lan truyền (cascading failures) sang các dịch vụ phụ thuộc vào nó.</p></li><li><p>Khó mở rộng: Việc mở rộng một dịch vụ có thể bị giới hạn bởi khả năng xử lý đồng bộ của các dịch vụ mà nó gọi.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-communication-giao-tiếp-bất-đồng-bộ">Asynchronous Communication (Giao tiếp bất đồng bộ):<a href="#asynchronous-communication-giao-tiếp-bất-đồng-bộ" class="hash-link" aria-label="Direct link to Asynchronous Communication (Giao tiếp bất đồng bộ):" title="Direct link to Asynchronous Communication (Giao tiếp bất đồng bộ):">​</a></h3><p>Một dịch vụ gửi đi một thông điệp (message) hoặc sự kiện (event) mà không cần đợi phản hồi ngay lập tức. Dịch vụ nhận sẽ xử lý thông điệp/sự kiện đó vào thời điểm thích hợp. Ví dụ là sử dụng Message Brokers (Kafka, RabbitMQ, Azure Service Bus), Webhooks. Thường liên quan chặt chẽ đến Event-Driven Architecture (EDA).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ưu-điểm-1">Ưu điểm:<a href="#ưu-điểm-1" class="hash-link" aria-label="Direct link to Ưu điểm:" title="Direct link to Ưu điểm:">​</a></h4><ul><li><p>Khớp nối lỏng (Loose coupling): Dịch vụ gửi và nhận không cần hoạt động cùng lúc.</p></li><li><p>Tăng khả năng phục hồi: Lỗi ở một dịch vụ ít ảnh hưởng đến các dịch vụ khác. Nếu dịch vụ nhận lỗi, thông điệp/sự kiện thường có thể được lưu lại và xử lý sau.</p></li><li><p>Tăng khả năng mở rộng: Dễ dàng thêm các dịch vụ nhận mới hoặc tăng số lượng phiên bản của dịch vụ nhận để xử lý tải.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nhược-điểm-1">Nhược điểm:<a href="#nhược-điểm-1" class="hash-link" aria-label="Direct link to Nhược điểm:" title="Direct link to Nhược điểm:">​</a></h4><ul><li><p>Phức tạp hơn: Cần có hạ tầng Message Broker. Luồng xử lý khó theo dõi hơn.</p></li><li><p>Tính nhất quán cuối cùng (Eventual consistency): Dữ liệu có thể không được cập nhật đồng nhất ngay lập tức trên toàn hệ thống.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="các-mẫu-giao-tiếp-phổ-biến">Các mẫu giao tiếp phổ biến:<a href="#các-mẫu-giao-tiếp-phổ-biến" class="hash-link" aria-label="Direct link to Các mẫu giao tiếp phổ biến:" title="Direct link to Các mẫu giao tiếp phổ biến:">​</a></h3><ul><li><p>API Gateway: Đóng vai trò là một cổng vào duy nhất cho tất cả các yêu cầu từ client bên ngoài đến hệ thống microservices. Nó có thể xử lý routing, xác thực, tổng hợp kết quả từ nhiều service, caching, rate limiting... giúp đơn giản hóa phía client và bảo vệ các service bên trong.</p></li><li><p>Backend for Frontend (BFF): Một biến thể của API Gateway, nơi mỗi loại client (ví dụ: web app, mobile app) có một API Gateway riêng, được tối ưu hóa cho nhu cầu cụ thể của client đó.</p></li><li><p>Service Discovery: Giúp các microservices tìm thấy địa chỉ mạng (IP, port) của nhau một cách động, thay vì phải cấu hình cứng địa chỉ. Thường bao gồm hai phần chính:</p><ol><li><p>Service Registry (Sổ đăng ký dịch vụ):</p><ul><li>Là một cơ sở dữ liệu hoặc dịch vụ trung tâm nơi mỗi phiên bản dịch vụ tự đăng ký thông tin vị trí của nó (IP, port, metadata) khi khởi động.</li><li>Các phiên bản dịch vụ cũng thường gửi các tín hiệu &quot;heartbeat&quot; (nhịp tim) để báo rằng chúng vẫn còn hoạt động. Nếu không nhận được heartbeat, Registry sẽ tự động hủy đăng ký (deregister) phiên bản đó.</li><li>Ví dụ về Service Registry: Consul, Eureka, etcd, Zookeeper.</li></ul></li><li><p>Discovery Mechanism (Cơ chế khám phá): Cách client tìm ra địa chỉ của provider. Có hai cách chính:</p><ul><li>Client-Side Discovery: Client tự truy vấn Service Registry để lấy danh sách các địa chỉ khả dụng của dịch vụ đích, sau đó tự chọn một địa chỉ (thường thông qua thuật toán cân bằng tải như Round Robin).</li><li>Server-Side Discovery: Client gửi yêu cầu đến một thành phần trung gian (như Load Balancer hoặc API Gateway). Thành phần này sẽ truy vấn Service Registry, chọn một địa chỉ dịch vụ đích phù hợp và chuyển tiếp yêu cầu đến đó. Client không cần biết về sự tồn tại của Service Registry.</li></ul></li></ol></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="microservice-resiliency-patterns">Microservice Resiliency Patterns<a href="#microservice-resiliency-patterns" class="hash-link" aria-label="Direct link to Microservice Resiliency Patterns" title="Direct link to Microservice Resiliency Patterns">​</a></h2><p>Trong một hệ thống phân tán như microservices, lỗi là điều khó tránh khỏi (lỗi mạng, lỗi dịch vụ, quá tải...). Các mẫu resiliency giúp hệ thống vẫn hoạt động ổn định hoặc phục hồi nhanh chóng khi có lỗi xảy ra.</p><p>Các mẫu phục hồi phổ biến:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="circuit-breaker-ngắt-mạch">Circuit Breaker (Ngắt mạch)<a href="#circuit-breaker-ngắt-mạch" class="hash-link" aria-label="Direct link to Circuit Breaker (Ngắt mạch)" title="Direct link to Circuit Breaker (Ngắt mạch)">​</a></h3><p>Hoạt động giống như cầu dao điện. Khi số lượng lỗi khi gọi một dịch vụ cụ thể vượt ngưỡng cho phép, Circuit Breaker sẽ &quot;mở&quot; (open), ngăn chặn các yêu cầu tiếp theo đến dịch vụ đó trong một khoảng thời gian. Thay vì gọi dịch vụ lỗi, nó có thể trả về lỗi ngay lập tức hoặc một giá trị mặc định (fallback). Sau một thời gian, nó sẽ chuyển sang trạng thái &quot;nửa mở&quot; (half-open) để thử gửi lại một vài yêu cầu. Nếu thành công, mạch sẽ &quot;đóng&quot; (closed) lại; nếu thất bại, nó lại &quot;mở&quot;.</p><p>Ngăn chặn việc lãng phí tài nguyên vào việc gọi một dịch vụ đang gặp sự cố, tránh lỗi lan truyền, cho phép dịch vụ bị lỗi có thời gian phục hồi.</p><ul><li>Thuật toán/Logic: Cần duy trì trạng thái của &quot;mạch&quot; cho mỗi dịch vụ đích.<ul><li>Trạng thái: CLOSED (Cho phép yêu cầu), OPEN (Từ chối yêu cầu), HALF_OPEN (Thử nghiệm một vài yêu cầu).</li><li>Biến đếm: Đếm số lỗi liên tiếp (trong CLOSED), số thành công liên tiếp (trong HALF_OPEN).</li><li>Ngưỡng: Số lỗi tối đa cho phép trước khi chuyển sang OPEN.</li><li>Thời gian chờ (Timeout): Khoảng thời gian ở trạng thái OPEN trước khi chuyển sang HALF_OPEN.</li></ul></li><li>Luồng hoạt động:<ul><li>CLOSED: Gửi yêu cầu. Nếu thành công, reset bộ đếm lỗi. Nếu lỗi, tăng bộ đếm lỗi. Nếu bộ đếm lỗi vượt ngưỡng -&gt; chuyển sang OPEN, bắt đầu đếm thời gian chờ.</li><li>OPEN: Từ chối ngay lập tức mọi yêu cầu (hoặc trả về giá trị mặc định/fallback). Khi hết thời gian chờ -&gt; chuyển sang HALF_OPEN.</li><li>HALF_OPEN: Cho phép một số lượng giới hạn yêu cầu đi qua. Nếu yêu cầu thành công -&gt; chuyển về CLOSED, reset bộ đếm. Nếu yêu cầu thất bại -&gt; quay lại OPEN, bắt đầu lại thời gian chờ.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="retry-thử-lại">Retry (Thử lại)<a href="#retry-thử-lại" class="hash-link" aria-label="Direct link to Retry (Thử lại)" title="Direct link to Retry (Thử lại)">​</a></h3><p>Tự động thực hiện lại một yêu cầu nếu nó thất bại (thường là do lỗi tạm thời như lỗi mạng). Nên kết hợp với cơ chế chờ tăng dần (exponential backoff) để tránh làm quá tải dịch vụ đích.</p><p>Xử lý các lỗi tạm thời một cách tự động.</p><p>Chỉ nên retry các thao tác an toàn (idempotent - thực hiện nhiều lần cho kết quả như một lần) hoặc khi biết chắc lỗi là tạm thời.</p><ul><li>Vòng lặp: Đặt lời gọi dịch vụ bên trong một vòng lặp (ví dụ: for hoặc while).
Biến đếm: Giới hạn số lần thử lại tối đa.</li><li>Xử lý lỗi: Bắt lỗi từ lời gọi dịch vụ. Kiểm tra xem lỗi có thuộc loại nên thử lại hay không (ví dụ: lỗi mạng tạm thời, lỗi 5xx, không phải lỗi 4xx như Bad Request).</li><li>Delay (Trì hoãn): Trước khi thử lại, đợi một khoảng thời gian.</li><li>Backoff: Thường sử dụng chiến lược tăng thời gian chờ giữa các lần thử lại (ví dụ: Exponential Backoff - thời gian chờ = base_delay <!-- -->*<!-- --> 2 ^ (số_lần_thử_lại)), để tránh làm quá tải dịch vụ đích.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="timeout-hết-thời-gian-chờ">Timeout (Hết thời gian chờ)<a href="#timeout-hết-thời-gian-chờ" class="hash-link" aria-label="Direct link to Timeout (Hết thời gian chờ)" title="Direct link to Timeout (Hết thời gian chờ)">​</a></h3><p>Đặt một khoảng thời gian chờ tối đa cho một yêu cầu. Nếu không nhận được phản hồi trong khoảng thời gian đó, yêu cầu sẽ bị hủy và coi là thất bại.</p><p>Tránh việc một dịch vụ bị treo vô thời hạn khi chờ đợi một dịch vụ khác phản hồi quá chậm.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bulkhead-vách-ngăn">Bulkhead (Vách ngăn)<a href="#bulkhead-vách-ngăn" class="hash-link" aria-label="Direct link to Bulkhead (Vách ngăn)" title="Direct link to Bulkhead (Vách ngăn)">​</a></h3><p>Cách ly các tài nguyên (ví dụ: connection pool, thread pool) được sử dụng để tương tác với các dịch vụ khác nhau. Nếu một dịch vụ đích bị chậm hoặc lỗi, nó chỉ làm cạn kiệt tài nguyên trong &quot;vách ngăn&quot; của nó, không ảnh hưởng đến khả năng gọi các dịch vụ khác.</p><p>Ngăn chặn lỗi của một thành phần ảnh hưởng đến toàn bộ hệ thống.</p><ul><li>Phân nhóm: Xác định các nhóm tài nguyên riêng biệt cho các lời gọi đến các dịch vụ đích khác nhau (hoặc các loại yêu cầu khác nhau).</li><li>Giới hạn tài nguyên: Sử dụng các cơ chế như:<ul><li>Thread Pools: Cấp phát các pool luồng riêng biệt cho mỗi nhóm. Nếu pool đầy, yêu cầu mới cho nhóm đó sẽ bị từ chối hoặc đưa vào hàng đợi.</li><li>Semaphores: Sử dụng semaphore để giới hạn số lượng yêu cầu đồng thời cho mỗi nhóm.</li><li>Connection Pools: Sử dụng các pool kết nối cơ sở dữ liệu/HTTP riêng biệt.</li></ul></li><li>Cách ly: Đảm bảo rằng việc cạn kiệt tài nguyên trong một &quot;vách ngăn&quot; không ảnh hưởng đến các &quot;vách ngăn&quot; khác.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limiter-giới-hạn-tần-suất">Rate Limiter (Giới hạn tần suất)<a href="#rate-limiter-giới-hạn-tần-suất" class="hash-link" aria-label="Direct link to Rate Limiter (Giới hạn tần suất)" title="Direct link to Rate Limiter (Giới hạn tần suất)">​</a></h3><p>Kiểm soát số lượng yêu cầu mà một dịch vụ gửi đi hoặc chấp nhận trong một khoảng thời gian nhất định.</p><p>Bảo vệ dịch vụ khỏi bị quá tải bởi số lượng yêu cầu lớn đột ngột.</p><ul><li>Token Bucket:<ul><li>Duy trì một &quot;xô&quot; chứa &quot;token&quot;, được đổ đầy lại với một tốc độ cố định.</li><li>Mỗi yêu cầu đến cần lấy 1 token từ xô. Nếu xô hết token, yêu cầu bị từ chối/xếp hàng.</li><li>Cần lưu số lượng token hiện tại và thời điểm đổ đầy token lần cuối.</li></ul></li><li>Leaky Bucket:<ul><li>Yêu cầu đến được đưa vào một hàng đợi (xô) có kích thước cố định.</li><li>Xử lý yêu cầu từ hàng đợi với một tốc độ cố định (như nước rỉ ra từ xô).</li><li>Nếu hàng đợi đầy, yêu cầu mới bị từ chối.</li></ul></li><li>Fixed Window Counter:<ul><li>Chia thời gian thành các cửa sổ cố định (ví dụ: 60 giây).</li><li>Đếm số yêu cầu trong cửa sổ hiện tại.</li><li>Nếu số yêu cầu vượt ngưỡng, từ chối yêu cầu mới.</li><li>Reset bộ đếm khi bắt đầu cửa sổ mới.</li></ul></li><li>Sliding Window Log:<ul><li>Lưu trữ timestamp của các yêu cầu gần đây trong một danh sách/log.</li><li>Khi có yêu cầu mới, xóa các timestamp cũ hơn khoảng thời gian giới hạn (ví dụ: cũ hơn 60 giây).</li><li>Đếm số timestamp còn lại. Nếu vượt ngưỡng, từ chối. Thêm timestamp mới nếu chấp nhận.</li></ul></li><li>Sliding Window Counter (Hiệu quả hơn): Kết hợp ý tưởng của Fixed Window và Sliding Log để ước tính số lượng yêu cầu trong cửa sổ trượt mà không cần lưu tất cả timestamp.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/system-design/event-driven"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Event-Driven Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/system-design/serverless"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Serverless Architecture</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#communication-patterns" class="table-of-contents__link toc-highlight">Communication Patterns</a><ul><li><a href="#synchronous-communication-giao-tiếp-đồng-bộ" class="table-of-contents__link toc-highlight">Synchronous Communication (Giao tiếp đồng bộ):</a></li><li><a href="#asynchronous-communication-giao-tiếp-bất-đồng-bộ" class="table-of-contents__link toc-highlight">Asynchronous Communication (Giao tiếp bất đồng bộ):</a></li><li><a href="#các-mẫu-giao-tiếp-phổ-biến" class="table-of-contents__link toc-highlight">Các mẫu giao tiếp phổ biến:</a></li></ul></li><li><a href="#microservice-resiliency-patterns" class="table-of-contents__link toc-highlight">Microservice Resiliency Patterns</a><ul><li><a href="#circuit-breaker-ngắt-mạch" class="table-of-contents__link toc-highlight">Circuit Breaker (Ngắt mạch)</a></li><li><a href="#retry-thử-lại" class="table-of-contents__link toc-highlight">Retry (Thử lại)</a></li><li><a href="#timeout-hết-thời-gian-chờ" class="table-of-contents__link toc-highlight">Timeout (Hết thời gian chờ)</a></li><li><a href="#bulkhead-vách-ngăn" class="table-of-contents__link toc-highlight">Bulkhead (Vách ngăn)</a></li><li><a href="#rate-limiter-giới-hạn-tần-suất" class="table-of-contents__link toc-highlight">Rate Limiter (Giới hạn tần suất)</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/icon.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="40" height="40"><img src="/img/icon.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="40" height="40"></a></div><div class="footer__copyright">Copyright © 2025 Quan Kori</div></div></div></footer></div>
<script src="/assets/js/runtime~main.77d03480.js"></script>
<script src="/assets/js/main.447d2fc2.js"></script>
</body>
</html>